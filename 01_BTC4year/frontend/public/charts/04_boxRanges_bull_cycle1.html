<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cycle 1 Bull - Box Range Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; overflow: hidden; }
        body { font-family: 'Inter', sans-serif; background: linear-gradient(180deg, #020617 0%, #0F172A 100%); height: 100vh; padding: 20px; display: flex; flex-direction: column; }
        .container { flex: 1; display: flex; flex-direction: column; max-width: 1400px; width: 100%; margin: 0 auto; min-height: 0; }
        .chart-wrapper { flex: 1; display: flex; flex-direction: column; background: linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #0F172A 100%); border-radius: 16px; padding: 20px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.05); min-height: 0; }
        .header { flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 12px; }
        .header h2 { font-size: 18px; font-weight: 700; color: #F8FAFC; }
        .header p { font-size: 12px; color: #64748B; margin-top: 4px; }
        #chart { flex: 1; margin: 0 -12px; min-height: 0; }
        .footer { flex-shrink: 0; display: flex; justify-content: center; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.06); font-size: 11px; color: #64748B; }
    </style>
</head>
<body>
    <div class="container">
        <div class="chart-wrapper">
            <div class="header">
                <div>
                    <h2>Cycle 1 Bull (2015.01~2017.12) - Correction Box Range Analysis</h2>
                    <p>Drop ≥5.0%, Breakup &lt;2.0%</p>
                </div>
            </div>
            <div id="chart"></div>
            <div class="footer">Data source: Supabase BTC/USDT OHLCV (Day 420~1471)</div>
        </div>
    </div>
    <script>
        var series = [{"name": "Cycle 1", "data": [{"x": 420, "y": 21.63}, {"x": 421, "y": 19.51}, {"x": 422, "y": 19.78}, {"x": 423, "y": 19.02}, {"x": 424, "y": 18.7}, {"x": 425, "y": 19.59}, {"x": 426, "y": 20.0}, {"x": 427, "y": 18.64}, {"x": 428, "y": 18.58}, {"x": 429, "y": 18.28}, {"x": 430, "y": 18.67}, {"x": 431, "y": 18.6}, {"x": 432, "y": 18.18}, {"x": 433, "y": 17.95}, {"x": 434, "y": 18.06}, {"x": 435, "y": 18.02}, {"x": 436, "y": 19.52}, {"x": 437, "y": 21.11}, {"x": 438, "y": 21.38}, {"x": 439, "y": 19.39}, {"x": 440, "y": 19.97}, {"x": 441, "y": 19.84}, {"x": 442, "y": 19.72}, {"x": 443, "y": 20.02}, {"x": 444, "y": 19.98}, {"x": 445, "y": 19.92}, {"x": 446, "y": 19.4}, {"x": 447, "y": 19.42}, {"x": 448, "y": 19.36}, {"x": 449, "y": 19.25}, {"x": 450, "y": 20.9}, {"x": 451, "y": 20.64}, {"x": 452, "y": 21.06}, {"x": 453, "y": 22.2}, {"x": 454, "y": 23.2}, {"x": 455, "y": 22.99}, {"x": 456, "y": 22.69}, {"x": 457, "y": 22.46}, {"x": 458, "y": 22.49}, {"x": 459, "y": 22.53}, {"x": 460, "y": 23.7}, {"x": 461, "y": 24.32}, {"x": 462, "y": 24.05}, {"x": 463, "y": 24.0}, {"x": 464, "y": 23.83}, {"x": 465, "y": 23.3}, {"x": 466, "y": 23.14}, {"x": 467, "y": 23.76}, {"x": 468, "y": 23.63}, {"x": 469, "y": 23.08}, {"x": 470, "y": 21.4}, {"x": 471, "y": 21.39}, {"x": 472, "y": 21.28}, {"x": 473, "y": 21.85}, {"x": 474, "y": 21.9}, {"x": 475, "y": 21.57}, {"x": 476, "y": 20.14}, {"x": 477, "y": 20.58}, {"x": 478, "y": 20.21}, {"x": 479, "y": 20.55}, {"x": 480, "y": 20.43}, {"x": 481, "y": 20.1}, {"x": 482, "y": 20.1}, {"x": 483, "y": 20.01}, {"x": 484, "y": 20.6}, {"x": 485, "y": 20.73}, {"x": 486, "y": 20.62}, {"x": 487, "y": 21.03}, {"x": 488, "y": 21.13}, {"x": 489, "y": 20.65}, {"x": 490, "y": 20.55}, {"x": 491, "y": 19.89}, {"x": 492, "y": 19.72}, {"x": 493, "y": 19.39}, {"x": 494, "y": 19.19}, {"x": 495, "y": 19.13}, {"x": 496, "y": 18.16}, {"x": 497, "y": 18.07}, {"x": 498, "y": 18.54}, {"x": 499, "y": 18.53}, {"x": 500, "y": 18.14}, {"x": 501, "y": 18.33}, {"x": 502, "y": 18.32}, {"x": 503, "y": 19.01}, {"x": 504, "y": 19.26}, {"x": 505, "y": 19.08}, {"x": 506, "y": 19.12}, {"x": 507, "y": 18.77}, {"x": 508, "y": 18.32}, {"x": 509, "y": 19.6}, {"x": 510, "y": 18.58}, {"x": 511, "y": 18.36}, {"x": 512, "y": 19.39}, {"x": 513, "y": 19.34}, {"x": 514, "y": 19.1}, {"x": 515, "y": 19.68}, {"x": 516, "y": 19.65}, {"x": 517, "y": 19.36}, {"x": 518, "y": 19.16}, {"x": 519, "y": 19.42}, {"x": 520, "y": 19.96}, {"x": 521, "y": 20.03}, {"x": 522, "y": 19.78}, {"x": 523, "y": 19.71}, {"x": 524, "y": 19.63}, {"x": 525, "y": 19.71}, {"x": 526, "y": 19.33}, {"x": 527, "y": 19.3}, {"x": 528, "y": 19.21}, {"x": 529, "y": 19.21}, {"x": 530, "y": 19.16}, {"x": 531, "y": 18.95}, {"x": 532, "y": 19.0}, {"x": 533, "y": 19.12}, {"x": 534, "y": 19.55}, {"x": 535, "y": 19.53}, {"x": 536, "y": 19.59}, {"x": 537, "y": 19.54}, {"x": 538, "y": 19.31}, {"x": 539, "y": 19.3}, {"x": 540, "y": 19.26}, {"x": 541, "y": 19.22}, {"x": 542, "y": 19.16}, {"x": 543, "y": 18.91}, {"x": 544, "y": 18.73}, {"x": 545, "y": 18.37}, {"x": 546, "y": 18.41}, {"x": 547, "y": 18.32}, {"x": 548, "y": 18.29}, {"x": 549, "y": 18.24}, {"x": 550, "y": 18.29}, {"x": 551, "y": 18.58}, {"x": 552, "y": 18.7}, {"x": 553, "y": 18.62}, {"x": 554, "y": 18.63}, {"x": 555, "y": 18.71}, {"x": 556, "y": 18.83}, {"x": 557, "y": 19.03}, {"x": 558, "y": 19.28}, {"x": 559, "y": 20.53}, {"x": 560, "y": 20.89}, {"x": 561, "y": 20.35}, {"x": 562, "y": 20.27}, {"x": 563, "y": 19.93}, {"x": 564, "y": 19.88}, {"x": 565, "y": 20.09}, {"x": 566, "y": 20.01}, {"x": 567, "y": 19.76}, {"x": 568, "y": 19.68}, {"x": 569, "y": 19.68}, {"x": 570, "y": 20.33}, {"x": 571, "y": 20.33}, {"x": 572, "y": 20.81}, {"x": 573, "y": 21.71}, {"x": 574, "y": 21.41}, {"x": 575, "y": 21.11}, {"x": 576, "y": 20.74}, {"x": 577, "y": 21.1}, {"x": 578, "y": 22.15}, {"x": 579, "y": 22.42}, {"x": 580, "y": 21.92}, {"x": 581, "y": 22.11}, {"x": 582, "y": 22.0}, {"x": 583, "y": 24.07}, {"x": 584, "y": 24.14}, {"x": 585, "y": 25.53}, {"x": 586, "y": 25.12}, {"x": 587, "y": 24.0}, {"x": 588, "y": 23.67}, {"x": 589, "y": 23.5}, {"x": 590, "y": 22.69}, {"x": 591, "y": 22.83}, {"x": 592, "y": 22.39}, {"x": 593, "y": 22.54}, {"x": 594, "y": 22.71}, {"x": 595, "y": 22.41}, {"x": 596, "y": 22.45}, {"x": 597, "y": 23.42}, {"x": 598, "y": 23.53}, {"x": 599, "y": 23.7}, {"x": 600, "y": 23.9}, {"x": 601, "y": 23.97}, {"x": 602, "y": 23.81}, {"x": 603, "y": 23.42}, {"x": 604, "y": 23.33}, {"x": 605, "y": 22.99}, {"x": 606, "y": 22.83}, {"x": 607, "y": 23.03}, {"x": 608, "y": 23.09}, {"x": 609, "y": 23.07}, {"x": 610, "y": 22.79}, {"x": 611, "y": 22.59}, {"x": 612, "y": 22.54}, {"x": 613, "y": 21.56}, {"x": 614, "y": 21.54}, {"x": 615, "y": 21.81}, {"x": 616, "y": 21.94}, {"x": 617, "y": 21.69}, {"x": 618, "y": 21.59}, {"x": 619, "y": 21.53}, {"x": 620, "y": 21.16}, {"x": 621, "y": 21.0}, {"x": 622, "y": 20.81}, {"x": 623, "y": 20.03}, {"x": 624, "y": 19.23}, {"x": 625, "y": 19.09}, {"x": 626, "y": 19.0}, {"x": 627, "y": 18.8}, {"x": 628, "y": 18.46}, {"x": 629, "y": 18.31}, {"x": 630, "y": 18.64}, {"x": 631, "y": 18.46}, {"x": 632, "y": 18.97}, {"x": 633, "y": 18.83}, {"x": 634, "y": 18.77}, {"x": 635, "y": 18.73}, {"x": 636, "y": 18.7}, {"x": 637, "y": 18.63}, {"x": 638, "y": 18.55}, {"x": 639, "y": 18.67}, {"x": 640, "y": 19.04}, {"x": 641, "y": 19.68}, {"x": 642, "y": 19.61}, {"x": 643, "y": 19.91}, {"x": 644, "y": 19.74}, {"x": 645, "y": 19.44}, {"x": 646, "y": 19.47}, {"x": 647, "y": 19.42}, {"x": 648, "y": 19.09}, {"x": 649, "y": 18.79}, {"x": 650, "y": 19.62}, {"x": 651, "y": 18.66}, {"x": 652, "y": 19.0}, {"x": 653, "y": 18.96}, {"x": 654, "y": 18.86}, {"x": 655, "y": 18.8}, {"x": 656, "y": 18.71}, {"x": 657, "y": 18.84}, {"x": 658, "y": 18.76}, {"x": 659, "y": 19.05}, {"x": 660, "y": 19.2}, {"x": 661, "y": 19.04}, {"x": 662, "y": 18.97}, {"x": 663, "y": 19.42}, {"x": 664, "y": 19.42}, {"x": 665, "y": 19.21}, {"x": 666, "y": 19.29}, {"x": 667, "y": 19.26}, {"x": 668, "y": 19.35}, {"x": 669, "y": 22.43}, {"x": 670, "y": 19.43}, {"x": 671, "y": 20.01}, {"x": 672, "y": 19.98}, {"x": 673, "y": 19.78}, {"x": 674, "y": 19.76}, {"x": 675, "y": 19.87}, {"x": 676, "y": 20.06}, {"x": 677, "y": 20.04}, {"x": 678, "y": 20.3}, {"x": 679, "y": 20.61}, {"x": 680, "y": 20.75}, {"x": 681, "y": 21.6}, {"x": 682, "y": 22.25}, {"x": 683, "y": 22.01}, {"x": 684, "y": 21.49}, {"x": 685, "y": 21.99}, {"x": 686, "y": 21.99}, {"x": 687, "y": 22.52}, {"x": 688, "y": 22.61}, {"x": 689, "y": 22.87}, {"x": 690, "y": 23.88}, {"x": 691, "y": 23.24}, {"x": 692, "y": 24.11}, {"x": 693, "y": 24.85}, {"x": 694, "y": 25.74}, {"x": 695, "y": 27.06}, {"x": 696, "y": 26.93}, {"x": 697, "y": 26.2}, {"x": 698, "y": 29.56}, {"x": 699, "y": 33.68}, {"x": 700, "y": 39.82}, {"x": 701, "y": 36.13}, {"x": 702, "y": 32.03}, {"x": 703, "y": 31.66}, {"x": 704, "y": 31.5}, {"x": 705, "y": 31.12}, {"x": 706, "y": 30.82}, {"x": 707, "y": 27.62}, {"x": 708, "y": 27.97}, {"x": 709, "y": 27.62}, {"x": 710, "y": 29.88}, {"x": 711, "y": 27.05}, {"x": 712, "y": 26.83}, {"x": 713, "y": 27.71}, {"x": 714, "y": 27.26}, {"x": 715, "y": 27.12}, {"x": 716, "y": 26.43}, {"x": 717, "y": 26.54}, {"x": 718, "y": 26.41}, {"x": 719, "y": 26.26}, {"x": 720, "y": 26.12}, {"x": 721, "y": 26.66}, {"x": 722, "y": 29.81}, {"x": 723, "y": 29.4}, {"x": 724, "y": 29.1}, {"x": 725, "y": 30.12}, {"x": 726, "y": 30.91}, {"x": 727, "y": 30.62}, {"x": 728, "y": 29.36}, {"x": 729, "y": 30.01}, {"x": 730, "y": 29.41}, {"x": 731, "y": 31.54}, {"x": 732, "y": 32.5}, {"x": 733, "y": 32.22}, {"x": 734, "y": 33.22}, {"x": 735, "y": 34.31}, {"x": 736, "y": 33.97}, {"x": 737, "y": 36.64}, {"x": 738, "y": 37.79}, {"x": 739, "y": 35.63}, {"x": 740, "y": 36.32}, {"x": 741, "y": 37.51}, {"x": 742, "y": 37.59}, {"x": 743, "y": 37.04}, {"x": 744, "y": 37.66}, {"x": 745, "y": 37.65}, {"x": 746, "y": 37.39}, {"x": 747, "y": 36.0}, {"x": 748, "y": 35.81}, {"x": 749, "y": 35.94}, {"x": 750, "y": 37.22}, {"x": 751, "y": 36.96}, {"x": 752, "y": 36.89}, {"x": 753, "y": 34.38}, {"x": 754, "y": 34.74}, {"x": 755, "y": 35.04}, {"x": 756, "y": 35.15}, {"x": 757, "y": 35.0}, {"x": 758, "y": 35.39}, {"x": 759, "y": 35.34}, {"x": 760, "y": 35.08}, {"x": 761, "y": 35.17}, {"x": 762, "y": 35.17}, {"x": 763, "y": 34.91}, {"x": 764, "y": 36.97}, {"x": 765, "y": 37.4}, {"x": 766, "y": 36.72}, {"x": 767, "y": 36.27}, {"x": 768, "y": 36.45}, {"x": 769, "y": 36.23}, {"x": 770, "y": 35.85}, {"x": 771, "y": 35.04}, {"x": 772, "y": 34.75}, {"x": 773, "y": 31.25}, {"x": 774, "y": 31.57}, {"x": 775, "y": 31.29}, {"x": 776, "y": 31.25}, {"x": 777, "y": 34.4}, {"x": 778, "y": 34.21}, {"x": 779, "y": 33.25}, {"x": 780, "y": 31.95}, {"x": 781, "y": 32.76}, {"x": 782, "y": 32.63}, {"x": 783, "y": 32.13}, {"x": 784, "y": 32.11}, {"x": 785, "y": 31.95}, {"x": 786, "y": 31.17}, {"x": 787, "y": 30.85}, {"x": 788, "y": 30.74}, {"x": 789, "y": 30.69}, {"x": 790, "y": 30.43}, {"x": 791, "y": 30.37}, {"x": 792, "y": 31.66}, {"x": 793, "y": 31.6}, {"x": 794, "y": 31.22}, {"x": 795, "y": 30.91}, {"x": 796, "y": 30.78}, {"x": 797, "y": 30.51}, {"x": 798, "y": 31.14}, {"x": 799, "y": 30.96}, {"x": 800, "y": 31.22}, {"x": 801, "y": 31.72}, {"x": 802, "y": 32.8}, {"x": 803, "y": 33.2}, {"x": 804, "y": 33.11}, {"x": 805, "y": 34.06}, {"x": 806, "y": 34.38}, {"x": 807, "y": 34.28}, {"x": 808, "y": 35.77}, {"x": 809, "y": 36.17}, {"x": 810, "y": 35.57}, {"x": 811, "y": 35.62}, {"x": 812, "y": 34.36}, {"x": 813, "y": 34.52}, {"x": 814, "y": 34.55}, {"x": 815, "y": 35.08}, {"x": 816, "y": 35.2}, {"x": 817, "y": 35.66}, {"x": 818, "y": 35.47}, {"x": 819, "y": 35.22}, {"x": 820, "y": 34.41}, {"x": 821, "y": 34.21}, {"x": 822, "y": 33.14}, {"x": 823, "y": 33.29}, {"x": 824, "y": 33.66}, {"x": 825, "y": 33.67}, {"x": 826, "y": 33.52}, {"x": 827, "y": 33.73}, {"x": 828, "y": 34.13}, {"x": 829, "y": 33.99}, {"x": 830, "y": 33.61}, {"x": 831, "y": 33.62}, {"x": 832, "y": 33.73}, {"x": 833, "y": 33.69}, {"x": 834, "y": 33.9}, {"x": 835, "y": 33.82}, {"x": 836, "y": 33.17}, {"x": 837, "y": 33.41}, {"x": 838, "y": 33.38}, {"x": 839, "y": 33.77}, {"x": 840, "y": 33.9}, {"x": 841, "y": 33.75}, {"x": 842, "y": 33.72}, {"x": 843, "y": 33.75}, {"x": 844, "y": 34.53}, {"x": 845, "y": 34.37}, {"x": 846, "y": 34.3}, {"x": 847, "y": 33.63}, {"x": 848, "y": 33.71}, {"x": 849, "y": 33.69}, {"x": 850, "y": 33.94}, {"x": 851, "y": 33.95}, {"x": 852, "y": 33.97}, {"x": 853, "y": 34.24}, {"x": 854, "y": 34.16}, {"x": 855, "y": 34.1}, {"x": 856, "y": 34.22}, {"x": 857, "y": 33.85}, {"x": 858, "y": 34.07}, {"x": 859, "y": 34.13}, {"x": 860, "y": 34.48}, {"x": 861, "y": 34.47}, {"x": 862, "y": 34.37}, {"x": 863, "y": 34.7}, {"x": 864, "y": 34.91}, {"x": 865, "y": 34.79}, {"x": 866, "y": 34.67}, {"x": 867, "y": 35.24}, {"x": 868, "y": 35.79}, {"x": 869, "y": 36.43}, {"x": 870, "y": 36.38}, {"x": 871, "y": 36.48}, {"x": 872, "y": 37.31}, {"x": 873, "y": 37.67}, {"x": 874, "y": 37.89}, {"x": 875, "y": 37.81}, {"x": 876, "y": 36.37}, {"x": 877, "y": 36.87}, {"x": 878, "y": 36.92}, {"x": 879, "y": 36.7}, {"x": 880, "y": 36.68}, {"x": 881, "y": 36.48}, {"x": 882, "y": 36.43}, {"x": 883, "y": 36.3}, {"x": 884, "y": 37.29}, {"x": 885, "y": 37.22}, {"x": 886, "y": 37.18}, {"x": 887, "y": 37.51}, {"x": 888, "y": 37.34}, {"x": 889, "y": 36.85}, {"x": 890, "y": 36.79}, {"x": 891, "y": 36.94}, {"x": 892, "y": 36.98}, {"x": 893, "y": 37.19}, {"x": 894, "y": 37.14}, {"x": 895, "y": 36.87}, {"x": 896, "y": 36.89}, {"x": 897, "y": 36.78}, {"x": 898, "y": 36.18}, {"x": 899, "y": 35.97}, {"x": 900, "y": 35.89}, {"x": 901, "y": 35.96}, {"x": 902, "y": 36.19}, {"x": 903, "y": 36.46}, {"x": 904, "y": 36.71}, {"x": 905, "y": 38.72}, {"x": 906, "y": 42.97}, {"x": 907, "y": 44.28}, {"x": 908, "y": 43.97}, {"x": 909, "y": 44.19}, {"x": 910, "y": 43.82}, {"x": 911, "y": 43.75}, {"x": 912, "y": 46.36}, {"x": 913, "y": 47.89}, {"x": 914, "y": 47.16}, {"x": 915, "y": 47.41}, {"x": 916, "y": 47.78}, {"x": 917, "y": 47.06}, {"x": 918, "y": 46.92}, {"x": 919, "y": 46.81}, {"x": 920, "y": 47.88}, {"x": 921, "y": 55.25}, {"x": 922, "y": 58.03}, {"x": 923, "y": 56.76}, {"x": 924, "y": 56.17}, {"x": 925, "y": 62.19}, {"x": 926, "y": 62.37}, {"x": 927, "y": 62.7}, {"x": 928, "y": 61.82}, {"x": 929, "y": 61.78}, {"x": 930, "y": 59.16}, {"x": 931, "y": 54.77}, {"x": 932, "y": 50.86}, {"x": 933, "y": 55.54}, {"x": 934, "y": 55.6}, {"x": 935, "y": 53.75}, {"x": 936, "y": 52.55}, {"x": 937, "y": 53.27}, {"x": 938, "y": 52.19}, {"x": 939, "y": 54.38}, {"x": 940, "y": 55.36}, {"x": 941, "y": 56.6}, {"x": 942, "y": 56.68}, {"x": 943, "y": 54.86}, {"x": 944, "y": 54.88}, {"x": 945, "y": 54.82}, {"x": 946, "y": 54.64}, {"x": 947, "y": 53.6}, {"x": 948, "y": 53.61}, {"x": 949, "y": 52.68}, {"x": 950, "y": 53.13}, {"x": 951, "y": 54.4}, {"x": 952, "y": 54.3}, {"x": 953, "y": 53.48}, {"x": 954, "y": 53.94}, {"x": 955, "y": 53.77}, {"x": 956, "y": 55.02}, {"x": 957, "y": 54.98}, {"x": 958, "y": 54.4}, {"x": 959, "y": 54.32}, {"x": 960, "y": 53.85}, {"x": 961, "y": 54.09}, {"x": 962, "y": 53.18}, {"x": 963, "y": 53.67}, {"x": 964, "y": 53.53}, {"x": 965, "y": 53.15}, {"x": 966, "y": 53.26}, {"x": 967, "y": 53.17}, {"x": 968, "y": 53.12}, {"x": 969, "y": 53.13}, {"x": 970, "y": 52.92}, {"x": 971, "y": 50.74}, {"x": 972, "y": 49.6}, {"x": 973, "y": 46.31}, {"x": 974, "y": 47.26}, {"x": 975, "y": 46.86}, {"x": 976, "y": 48.21}, {"x": 977, "y": 48.16}, {"x": 978, "y": 48.01}, {"x": 979, "y": 47.77}, {"x": 980, "y": 48.52}, {"x": 981, "y": 48.42}, {"x": 982, "y": 47.76}, {"x": 983, "y": 47.68}, {"x": 984, "y": 47.33}, {"x": 985, "y": 46.46}, {"x": 986, "y": 47.14}, {"x": 987, "y": 46.95}, {"x": 988, "y": 46.82}, {"x": 989, "y": 46.7}, {"x": 990, "y": 47.15}, {"x": 991, "y": 47.29}, {"x": 992, "y": 47.83}, {"x": 993, "y": 47.66}, {"x": 994, "y": 47.23}, {"x": 995, "y": 46.92}, {"x": 996, "y": 47.08}, {"x": 997, "y": 46.9}, {"x": 998, "y": 46.57}, {"x": 999, "y": 46.75}, {"x": 1000, "y": 46.86}, {"x": 1001, "y": 46.73}, {"x": 1002, "y": 56.97}, {"x": 1003, "y": 46.67}, {"x": 1004, "y": 48.88}, {"x": 1005, "y": 49.71}, {"x": 1006, "y": 49.34}, {"x": 1007, "y": 49.45}, {"x": 1008, "y": 49.81}, {"x": 1009, "y": 50.85}, {"x": 1010, "y": 50.71}, {"x": 1011, "y": 50.7}, {"x": 1012, "y": 50.97}, {"x": 1013, "y": 49.34}, {"x": 1014, "y": 49.45}, {"x": 1015, "y": 49.47}, {"x": 1016, "y": 49.35}, {"x": 1017, "y": 49.32}, {"x": 1018, "y": 49.26}, {"x": 1019, "y": 49.48}, {"x": 1020, "y": 49.48}, {"x": 1021, "y": 49.39}, {"x": 1022, "y": 49.19}, {"x": 1023, "y": 48.46}, {"x": 1024, "y": 48.78}, {"x": 1025, "y": 48.96}, {"x": 1026, "y": 48.88}, {"x": 1027, "y": 49.17}, {"x": 1028, "y": 49.21}, {"x": 1029, "y": 49.04}, {"x": 1030, "y": 49.06}, {"x": 1031, "y": 49.19}, {"x": 1032, "y": 49.69}, {"x": 1033, "y": 49.63}, {"x": 1034, "y": 49.55}, {"x": 1035, "y": 49.51}, {"x": 1036, "y": 49.59}, {"x": 1037, "y": 49.51}, {"x": 1038, "y": 50.05}, {"x": 1039, "y": 50.06}, {"x": 1040, "y": 49.96}, {"x": 1041, "y": 50.0}, {"x": 1042, "y": 51.9}, {"x": 1043, "y": 51.91}, {"x": 1044, "y": 51.67}, {"x": 1045, "y": 51.75}, {"x": 1046, "y": 51.83}, {"x": 1047, "y": 51.89}, {"x": 1048, "y": 51.82}, {"x": 1049, "y": 51.66}, {"x": 1050, "y": 51.49}, {"x": 1051, "y": 50.97}, {"x": 1052, "y": 51.17}, {"x": 1053, "y": 53.32}, {"x": 1054, "y": 53.43}, {"x": 1055, "y": 52.87}, {"x": 1056, "y": 53.53}, {"x": 1057, "y": 54.82}, {"x": 1058, "y": 55.58}, {"x": 1059, "y": 55.62}, {"x": 1060, "y": 58.19}, {"x": 1061, "y": 57.77}, {"x": 1062, "y": 57.14}, {"x": 1063, "y": 59.34}, {"x": 1064, "y": 59.45}, {"x": 1065, "y": 60.15}, {"x": 1066, "y": 57.09}, {"x": 1067, "y": 57.08}, {"x": 1068, "y": 57.7}, {"x": 1069, "y": 57.51}, {"x": 1070, "y": 57.74}, {"x": 1071, "y": 59.89}, {"x": 1072, "y": 58.42}, {"x": 1073, "y": 58.16}, {"x": 1074, "y": 57.97}, {"x": 1075, "y": 57.01}, {"x": 1076, "y": 57.21}, {"x": 1077, "y": 57.93}, {"x": 1078, "y": 60.28}, {"x": 1079, "y": 60.75}, {"x": 1080, "y": 60.71}, {"x": 1081, "y": 61.03}, {"x": 1082, "y": 60.79}, {"x": 1083, "y": 60.14}, {"x": 1084, "y": 60.92}, {"x": 1085, "y": 60.67}, {"x": 1086, "y": 60.13}, {"x": 1087, "y": 59.9}, {"x": 1088, "y": 59.87}, {"x": 1089, "y": 59.66}, {"x": 1090, "y": 59.64}, {"x": 1091, "y": 59.55}, {"x": 1092, "y": 60.23}, {"x": 1093, "y": 61.05}, {"x": 1094, "y": 62.94}, {"x": 1095, "y": 62.4}, {"x": 1096, "y": 62.15}, {"x": 1097, "y": 62.15}, {"x": 1098, "y": 61.61}, {"x": 1099, "y": 62.14}, {"x": 1100, "y": 62.49}, {"x": 1101, "y": 62.5}, {"x": 1102, "y": 62.78}, {"x": 1103, "y": 62.56}, {"x": 1104, "y": 63.13}, {"x": 1105, "y": 63.86}, {"x": 1106, "y": 63.09}, {"x": 1107, "y": 63.05}, {"x": 1108, "y": 63.34}, {"x": 1109, "y": 63.96}, {"x": 1110, "y": 63.94}, {"x": 1111, "y": 64.13}, {"x": 1112, "y": 64.64}, {"x": 1113, "y": 67.32}, {"x": 1114, "y": 70.68}, {"x": 1115, "y": 74.36}, {"x": 1116, "y": 74.38}, {"x": 1117, "y": 72.33}, {"x": 1118, "y": 73.47}, {"x": 1119, "y": 75.78}, {"x": 1120, "y": 78.74}, {"x": 1121, "y": 79.4}, {"x": 1122, "y": 78.51}, {"x": 1123, "y": 78.01}, {"x": 1124, "y": 80.93}, {"x": 1125, "y": 83.36}, {"x": 1126, "y": 83.67}, {"x": 1127, "y": 92.8}, {"x": 1128, "y": 92.97}, {"x": 1129, "y": 83.02}, {"x": 1130, "y": 72.79}, {"x": 1131, "y": 75.64}, {"x": 1132, "y": 73.57}, {"x": 1133, "y": 73.63}, {"x": 1134, "y": 74.15}, {"x": 1135, "y": 66.92}, {"x": 1136, "y": 67.47}, {"x": 1137, "y": 67.78}, {"x": 1138, "y": 66.77}, {"x": 1139, "y": 67.61}, {"x": 1140, "y": 73.24}, {"x": 1141, "y": 73.83}, {"x": 1142, "y": 73.15}, {"x": 1143, "y": 72.84}, {"x": 1144, "y": 75.06}, {"x": 1145, "y": 75.82}, {"x": 1146, "y": 74.98}, {"x": 1147, "y": 74.79}, {"x": 1148, "y": 73.18}, {"x": 1149, "y": 74.28}, {"x": 1150, "y": 74.55}, {"x": 1151, "y": 74.49}, {"x": 1152, "y": 74.53}, {"x": 1153, "y": 74.52}, {"x": 1154, "y": 78.18}, {"x": 1155, "y": 79.72}, {"x": 1156, "y": 81.54}, {"x": 1157, "y": 82.72}, {"x": 1158, "y": 84.11}, {"x": 1159, "y": 83.52}, {"x": 1160, "y": 83.27}, {"x": 1161, "y": 85.17}, {"x": 1162, "y": 86.39}, {"x": 1163, "y": 86.7}, {"x": 1164, "y": 81.25}, {"x": 1165, "y": 81.96}, {"x": 1166, "y": 81.43}, {"x": 1167, "y": 81.42}, {"x": 1168, "y": 81.92}, {"x": 1169, "y": 81.68}, {"x": 1170, "y": 84.06}, {"x": 1171, "y": 85.44}, {"x": 1172, "y": 85.91}, {"x": 1173, "y": 85.37}, {"x": 1174, "y": 87.41}, {"x": 1175, "y": 90.74}, {"x": 1176, "y": 91.49}, {"x": 1177, "y": 95.48}, {"x": 1178, "y": 97.91}, {"x": 1179, "y": 95.35}, {"x": 1180, "y": 95.14}, {"x": 1181, "y": 96.62}, {"x": 1182, "y": 97.62}, {"x": 1183, "y": 98.98}, {"x": 1184, "y": 103.99}, {"x": 1185, "y": 104.34}, {"x": 1186, "y": 103.89}, {"x": 1187, "y": 102.88}, {"x": 1188, "y": 103.47}, {"x": 1189, "y": 103.5}, {"x": 1190, "y": 100.36}, {"x": 1191, "y": 97.53}, {"x": 1192, "y": 107.5}, {"x": 1193, "y": 97.18}, {"x": 1194, "y": 99.83}, {"x": 1195, "y": 100.65}, {"x": 1196, "y": 101.45}, {"x": 1197, "y": 101.56}, {"x": 1198, "y": 101.83}, {"x": 1199, "y": 94.93}, {"x": 1200, "y": 89.17}, {"x": 1201, "y": 85.95}, {"x": 1202, "y": 85.45}, {"x": 1203, "y": 90.94}, {"x": 1204, "y": 90.65}, {"x": 1205, "y": 85.88}, {"x": 1206, "y": 83.9}, {"x": 1207, "y": 80.48}, {"x": 1208, "y": 81.15}, {"x": 1209, "y": 84.74}, {"x": 1210, "y": 86.33}, {"x": 1211, "y": 85.54}, {"x": 1212, "y": 85.06}, {"x": 1213, "y": 87.93}, {"x": 1214, "y": 89.18}, {"x": 1215, "y": 89.65}, {"x": 1216, "y": 93.56}, {"x": 1217, "y": 93.83}, {"x": 1218, "y": 92.42}, {"x": 1219, "y": 97.09}, {"x": 1220, "y": 97.06}, {"x": 1221, "y": 96.82}, {"x": 1222, "y": 98.18}, {"x": 1223, "y": 98.17}, {"x": 1224, "y": 99.35}, {"x": 1225, "y": 99.02}, {"x": 1226, "y": 98.47}, {"x": 1227, "y": 96.59}, {"x": 1228, "y": 96.54}, {"x": 1229, "y": 95.99}, {"x": 1230, "y": 97.2}, {"x": 1231, "y": 98.09}, {"x": 1232, "y": 98.43}, {"x": 1233, "y": 100.73}, {"x": 1234, "y": 101.57}, {"x": 1235, "y": 101.57}, {"x": 1236, "y": 101.5}, {"x": 1237, "y": 101.52}, {"x": 1238, "y": 102.83}, {"x": 1239, "y": 105.79}, {"x": 1240, "y": 108.82}, {"x": 1241, "y": 109.58}, {"x": 1242, "y": 108.57}, {"x": 1243, "y": 109.8}, {"x": 1244, "y": 117.06}, {"x": 1245, "y": 118.87}, {"x": 1246, "y": 120.91}, {"x": 1247, "y": 130.07}, {"x": 1248, "y": 128.32}, {"x": 1249, "y": 126.08}, {"x": 1250, "y": 127.09}, {"x": 1251, "y": 134.75}, {"x": 1252, "y": 142.0}, {"x": 1253, "y": 142.71}, {"x": 1254, "y": 150.68}, {"x": 1255, "y": 147.26}, {"x": 1256, "y": 143.06}, {"x": 1257, "y": 145.67}, {"x": 1258, "y": 143.56}, {"x": 1259, "y": 141.61}, {"x": 1260, "y": 148.9}, {"x": 1261, "y": 160.03}, {"x": 1262, "y": 159.15}, {"x": 1263, "y": 165.51}, {"x": 1264, "y": 169.27}, {"x": 1265, "y": 183.0}, {"x": 1266, "y": 184.74}, {"x": 1267, "y": 201.76}, {"x": 1268, "y": 224.77}, {"x": 1269, "y": 211.42}, {"x": 1270, "y": 187.65}, {"x": 1271, "y": 185.88}, {"x": 1272, "y": 188.87}, {"x": 1273, "y": 188.21}, {"x": 1274, "y": 188.32}, {"x": 1275, "y": 198.84}, {"x": 1276, "y": 201.52}, {"x": 1277, "y": 208.69}, {"x": 1278, "y": 206.84}, {"x": 1279, "y": 218.6}, {"x": 1280, "y": 236.85}, {"x": 1281, "y": 232.78}, {"x": 1282, "y": 226.92}, {"x": 1283, "y": 230.45}, {"x": 1284, "y": 235.47}, {"x": 1285, "y": 240.62}, {"x": 1286, "y": 241.2}, {"x": 1287, "y": 225.02}, {"x": 1288, "y": 226.54}, {"x": 1289, "y": 203.75}, {"x": 1290, "y": 204.95}, {"x": 1291, "y": 217.41}, {"x": 1292, "y": 216.22}, {"x": 1293, "y": 211.52}, {"x": 1294, "y": 226.28}, {"x": 1295, "y": 226.6}, {"x": 1296, "y": 222.79}, {"x": 1297, "y": 222.99}, {"x": 1298, "y": 221.53}, {"x": 1299, "y": 214.99}, {"x": 1300, "y": 208.86}, {"x": 1301, "y": 208.88}, {"x": 1302, "y": 211.45}, {"x": 1303, "y": 210.56}, {"x": 1304, "y": 208.17}, {"x": 1305, "y": 204.4}, {"x": 1306, "y": 206.47}, {"x": 1307, "y": 211.5}, {"x": 1308, "y": 214.83}, {"x": 1309, "y": 213.53}, {"x": 1310, "y": 212.9}, {"x": 1311, "y": 211.5}, {"x": 1312, "y": 207.55}, {"x": 1313, "y": 208.2}, {"x": 1314, "y": 204.45}, {"x": 1315, "y": 194.96}, {"x": 1316, "y": 195.93}, {"x": 1317, "y": 196.89}, {"x": 1318, "y": 191.54}, {"x": 1319, "y": 180.76}, {"x": 1320, "y": 165.19}, {"x": 1321, "y": 180.49}, {"x": 1322, "y": 193.98}, {"x": 1323, "y": 194.93}, {"x": 1324, "y": 236.97}, {"x": 1325, "y": 232.22}, {"x": 1326, "y": 232.44}, {"x": 1327, "y": 230.83}, {"x": 1328, "y": 226.16}, {"x": 1329, "y": 224.56}, {"x": 1330, "y": 212.65}, {"x": 1331, "y": 219.21}, {"x": 1332, "y": 229.78}, {"x": 1333, "y": 227.22}, {"x": 1334, "y": 224.07}, {"x": 1335, "y": 235.64}, {"x": 1336, "y": 238.04}, {"x": 1337, "y": 224.13}, {"x": 1338, "y": 228.09}, {"x": 1339, "y": 233.73}, {"x": 1340, "y": 270.2}, {"x": 1341, "y": 266.25}, {"x": 1342, "y": 276.75}, {"x": 1343, "y": 282.39}, {"x": 1344, "y": 277.72}, {"x": 1345, "y": 279.07}, {"x": 1346, "y": 299.49}, {"x": 1347, "y": 320.56}, {"x": 1348, "y": 338.51}, {"x": 1349, "y": 350.41}, {"x": 1350, "y": 358.48}, {"x": 1351, "y": 355.37}, {"x": 1352, "y": 362.43}, {"x": 1353, "y": 353.23}, {"x": 1354, "y": 338.13}, {"x": 1355, "y": 340.26}, {"x": 1356, "y": 332.87}, {"x": 1357, "y": 331.68}, {"x": 1358, "y": 344.68}, {"x": 1359, "y": 353.24}, {"x": 1360, "y": 359.88}, {"x": 1361, "y": 352.86}, {"x": 1362, "y": 355.53}, {"x": 1363, "y": 355.51}, {"x": 1364, "y": 373.78}, {"x": 1365, "y": 375.53}, {"x": 1366, "y": 383.44}, {"x": 1367, "y": 394.76}, {"x": 1368, "y": 399.09}, {"x": 1369, "y": 380.96}, {"x": 1370, "y": 365.83}, {"x": 1371, "y": 362.39}, {"x": 1372, "y": 376.77}, {"x": 1373, "y": 386.93}, {"x": 1374, "y": 382.63}, {"x": 1375, "y": 357.68}, {"x": 1376, "y": 346.07}, {"x": 1377, "y": 350.23}, {"x": 1378, "y": 355.09}, {"x": 1379, "y": 336.57}, {"x": 1380, "y": 322.64}, {"x": 1381, "y": 311.57}, {"x": 1382, "y": 319.17}, {"x": 1383, "y": 302.86}, {"x": 1384, "y": 333.16}, {"x": 1385, "y": 330.48}, {"x": 1386, "y": 326.93}, {"x": 1387, "y": 315.93}, {"x": 1388, "y": 303.01}, {"x": 1389, "y": 308.43}, {"x": 1390, "y": 306.24}, {"x": 1391, "y": 321.58}, {"x": 1392, "y": 321.35}, {"x": 1393, "y": 343.4}, {"x": 1394, "y": 347.45}, {"x": 1395, "y": 344.53}, {"x": 1396, "y": 353.91}, {"x": 1397, "y": 356.05}, {"x": 1398, "y": 368.59}, {"x": 1399, "y": 360.97}, {"x": 1400, "y": 353.35}, {"x": 1401, "y": 351.89}, {"x": 1402, "y": 356.9}, {"x": 1403, "y": 361.95}, {"x": 1404, "y": 376.37}, {"x": 1405, "y": 395.12}, {"x": 1406, "y": 400.78}, {"x": 1407, "y": 394.44}, {"x": 1408, "y": 439.56}, {"x": 1409, "y": 472.38}, {"x": 1410, "y": 476.73}, {"x": 1411, "y": 478.53}, {"x": 1412, "y": 467.75}, {"x": 1413, "y": 466.63}, {"x": 1414, "y": 452.17}, {"x": 1415, "y": 461.38}, {"x": 1416, "y": 493.7}, {"x": 1417, "y": 498.63}, {"x": 1418, "y": 489.66}, {"x": 1419, "y": 491.27}, {"x": 1420, "y": 478.75}, {"x": 1421, "y": 460.97}, {"x": 1422, "y": 479.96}, {"x": 1423, "y": 483.19}, {"x": 1424, "y": 472.69}, {"x": 1425, "y": 500.15}, {"x": 1426, "y": 504.9}, {"x": 1427, "y": 525.05}, {"x": 1428, "y": 547.4}, {"x": 1429, "y": 589.85}, {"x": 1430, "y": 593.6}, {"x": 1431, "y": 604.48}, {"x": 1432, "y": 613.3}, {"x": 1433, "y": 598.01}, {"x": 1434, "y": 581.65}, {"x": 1435, "y": 627.83}, {"x": 1436, "y": 597.29}, {"x": 1437, "y": 588.23}, {"x": 1438, "y": 549.29}, {"x": 1439, "y": 535.71}, {"x": 1440, "y": 541.17}, {"x": 1441, "y": 540.16}, {"x": 1442, "y": 589.69}, {"x": 1443, "y": 641.56}, {"x": 1444, "y": 645.52}, {"x": 1445, "y": 631.87}, {"x": 1446, "y": 656.36}, {"x": 1447, "y": 672.27}, {"x": 1448, "y": 678.73}, {"x": 1449, "y": 672.49}, {"x": 1450, "y": 667.42}, {"x": 1451, "y": 676.23}, {"x": 1452, "y": 705.78}, {"x": 1453, "y": 755.49}, {"x": 1454, "y": 780.08}, {"x": 1455, "y": 803.09}, {"x": 1456, "y": 913.06}, {"x": 1457, "y": 880.74}, {"x": 1458, "y": 880.58}, {"x": 1459, "y": 904.17}, {"x": 1460, "y": 955.48}, {"x": 1461, "y": 937.3}, {"x": 1462, "y": 957.74}, {"x": 1463, "y": 1100.13}, {"x": 1464, "y": 1345.34}, {"x": 1465, "y": 1390.19}, {"x": 1466, "y": 1314.58}, {"x": 1467, "y": 1270.21}, {"x": 1468, "y": 1411.6}, {"x": 1469, "y": 1371.72}, {"x": 1470, "y": 1336.94}, {"x": 1471, "y": 1328.78}]}];
        var boxes = [{"Cycle": 1, "Box_ID": 1, "Start_Day": 438, "Start_Timestamp": "2015/02/15", "Start_Rate": 21.38, "Low_Day": 629, "Low_Timestamp": "2015/08/25", "Low_Rate": 15.86, "End_Day": 669, "End_Timestamp": "2015/10/04", "End_Rate": 22.43, "Drop_Percent": 5.52, "Duration_Days": 231, "Box_Broken": true, "color": "#3B82F6"}, {"Cycle": 1, "Box_ID": 2, "Start_Day": 700, "Start_Timestamp": "2015/11/04", "Start_Rate": 39.82, "Low_Day": 707, "Low_Timestamp": "2015/11/11", "Low_Rate": 23.63, "End_Day": 906, "End_Timestamp": "2016/05/28", "End_Rate": 42.97, "Drop_Percent": 16.19, "Duration_Days": 206, "Box_Broken": true, "color": "#10B981"}, {"Cycle": 1, "Box_ID": 3, "Start_Day": 927, "Start_Timestamp": "2016/06/18", "Start_Rate": 62.7, "Low_Day": 972, "Low_Timestamp": "2016/08/02", "Low_Rate": 38.09, "End_Day": 1109, "End_Timestamp": "2016/12/17", "End_Rate": 63.96, "Drop_Percent": 24.61, "Duration_Days": 182, "Box_Broken": true, "color": "#EF4444"}, {"Cycle": 1, "Box_ID": 4, "Start_Day": 1128, "Start_Timestamp": "2017/01/05", "Start_Rate": 92.97, "Low_Day": 1135, "Low_Timestamp": "2017/01/12", "Low_Rate": 59.75, "End_Day": 1177, "End_Timestamp": "2017/02/23", "End_Rate": 95.48, "Drop_Percent": 33.22, "Duration_Days": 49, "Box_Broken": true, "color": "#F59E0B"}, {"Cycle": 1, "Box_ID": 5, "Start_Day": 1192, "Start_Timestamp": "2017/03/10", "Start_Rate": 107.5, "Low_Day": 1228, "Low_Timestamp": "2017/04/15", "Low_Rate": 67.99, "End_Day": 1243, "End_Timestamp": "2017/04/30", "End_Rate": 109.8, "Drop_Percent": 39.5, "Duration_Days": 51, "Box_Broken": true, "color": "#8B5CF6"}, {"Cycle": 1, "Box_ID": 6, "Start_Day": 1268, "Start_Timestamp": "2017/05/25", "Start_Rate": 224.77, "Low_Day": 1270, "Low_Timestamp": "2017/05/27", "Low_Rate": 150.99, "End_Day": 1280, "End_Timestamp": "2017/06/06", "End_Rate": 236.85, "Drop_Percent": 73.79, "Duration_Days": 12, "Box_Broken": true, "color": "#EC4899"}, {"Cycle": 1, "Box_ID": 7, "Start_Day": 1286, "Start_Timestamp": "2017/06/12", "Start_Rate": 241.2, "Low_Day": 1320, "Low_Timestamp": "2017/07/16", "Low_Rate": 146.17, "End_Day": 1340, "End_Timestamp": "2017/08/05", "End_Rate": 270.2, "Drop_Percent": 95.03, "Duration_Days": 54, "Box_Broken": true, "color": "#06B6D4"}, {"Cycle": 1, "Box_ID": 8, "Start_Day": 1352, "Start_Timestamp": "2017/08/17", "Start_Rate": 362.43, "Low_Day": 1357, "Low_Timestamp": "2017/08/22", "Low_Rate": 274.73, "End_Day": 1364, "End_Timestamp": "2017/08/29", "End_Rate": 373.78, "Drop_Percent": 87.7, "Duration_Days": 12, "Box_Broken": true, "color": "#84CC16"}, {"Cycle": 1, "Box_ID": 9, "Start_Day": 1368, "Start_Timestamp": "2017/09/02", "Start_Rate": 399.09, "Low_Day": 1381, "Low_Timestamp": "2017/09/15", "Low_Rate": 227.62, "End_Day": 1408, "End_Timestamp": "2017/10/12", "End_Rate": 439.56, "Drop_Percent": 171.48, "Duration_Days": 40, "Box_Broken": true, "color": "#3B82F6"}, {"Cycle": 1, "Box_ID": 10, "Start_Day": 1468, "Start_Timestamp": "2017/12/11", "Start_Rate": 1411.6, "Low_Day": 1470, "Low_Timestamp": "2017/12/13", "Low_Rate": 1185.08, "End_Day": 1471, "End_Timestamp": "2017/12/14", "End_Rate": 1328.78, "Drop_Percent": 226.52, "Duration_Days": 3, "Box_Broken": true, "color": "#10B981"}];
        var chartInstance = null;

        // 마우스 위치에 따른 박스 정보 표시
        function getBoxAtPosition(dayX) {
            for (let box of boxes) {
                if (dayX >= box.Start_Day && dayX <= box.End_Day) {
                    return box;
                }
            }
            return null;
        }
        
        // 박스 사각형 그리기 함수
        function drawBoxRects(chartContext) {
            if (!chartContext) return;
            
            var chartEl = chartContext.el;
            var gridRect = chartEl.querySelector('.apexcharts-grid');
            if (!gridRect) return;
            
            // 기존 박스 rect 제거
            var oldRects = chartEl.querySelectorAll('.box-rect-group');
            oldRects.forEach(function(el) { el.remove(); });
            
            // 새 그룹 생성
            var rectGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            rectGroup.setAttribute('class', 'box-rect-group');
            
            var w = chartContext.w;
            
            // X축, Y축 config에서 고정값 사용
            var xMin = w.config.xaxis.min !== undefined ? w.config.xaxis.min : w.globals.minX;
            var xMax = w.config.xaxis.max !== undefined ? w.config.xaxis.max : w.globals.maxX;
            var yMin = w.config.yaxis[0].min !== undefined ? w.config.yaxis[0].min : 0;
            var yMax = w.config.yaxis[0].max !== undefined ? w.config.yaxis[0].max : 100;
            
            // 실제 그리드 영역 계산 (SVG 요소에서 직접)
            var gridBBox = gridRect.getBBox();
            var gridX = gridBBox.x;
            var gridY = gridBBox.y;
            var gridWidth = gridBBox.width;
            var gridHeight = gridBBox.height;
            
            boxes.forEach(function(box) {
                // X 좌표 계산 (Start_Day ~ End_Day)
                var x1 = gridX + ((box.Start_Day - xMin) / (xMax - xMin)) * gridWidth;
                var x2 = gridX + ((box.End_Day - xMin) / (xMax - xMin)) * gridWidth;
                
                // Y 좌표 계산 (bull: Start_Rate가 고점, Low_Rate가 저점)
                var yTop = gridY + ((yMax - box.Start_Rate) / (yMax - yMin)) * gridHeight;
                var yBottom = gridY + ((yMax - box.Low_Rate) / (yMax - yMin)) * gridHeight;
                
                var rectWidth = Math.abs(x2 - x1);
                var rectHeight = Math.abs(yBottom - yTop);
                var rectX = Math.min(x1, x2);
                var rectY = Math.min(yTop, yBottom);
                
                // 화면 범위 체크
                if (rectWidth > 0 && rectHeight > 0) {
                    var rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                    rect.setAttribute('x', rectX);
                    rect.setAttribute('y', rectY);
                    rect.setAttribute('width', rectWidth);
                    rect.setAttribute('height', rectHeight);
                    rect.setAttribute('fill', box.color);
                    rect.setAttribute('fill-opacity', '0.15');
                    rect.setAttribute('stroke', box.color);
                    rect.setAttribute('stroke-width', '1.5');
                    rect.setAttribute('stroke-opacity', '0.8');
                    rectGroup.appendChild(rect);
                }
            });
            
            // grid 뒤에 삽입
            if (gridRect && gridRect.parentNode) {
                gridRect.parentNode.insertBefore(rectGroup, gridRect);
            }
        }

        // point annotations (고점/저점 마커)
        var pointAnnotations = [];
        var highColor = '#EF4444';  // 고점: 빨강
        var lowColor = '#10B981';   // 저점: 초록
        
        boxes.forEach(function(box, idx) {
            // 전저점 찾기 (이전 박스의 저점, 없으면 현재 고점 기준)
            var prevLow = idx > 0 ? boxes[idx - 1].Low_Rate : box.Start_Rate;
            var riseFromPrevLow = ((box.Start_Rate - prevLow) / prevLow * 100).toFixed(0);
            
            // 고점 대비 하락률
            var dropFromHigh = (-(box.Start_Rate - box.Low_Rate) / box.Start_Rate * 100).toFixed(0);
            
            // 고점 마커 (삼각형, 원 위에 라벨)
            pointAnnotations.push({
                x: box.Start_Day,
                y: box.Start_Rate,
                marker: { size: 5, fillColor: highColor, strokeColor: '#fff', strokeWidth: 1, shape: 'triangle' },
                label: { 
                    borderColor: highColor, 
                    style: { color: '#fff', background: highColor, fontSize: '9px', padding: { left: 4, right: 4, top: 1, bottom: 1 } }, 
                    text: 'H' + box.Box_ID + ' ' + box.Start_Rate + '% 전저점:+' + riseFromPrevLow + '%', 
                    offsetY: -8 
                }
            });
            
            // 저점 마커 (원, 원 아래에 라벨)
            pointAnnotations.push({
                x: box.Low_Day,
                y: box.Low_Rate,
                marker: { size: 5, fillColor: lowColor, strokeColor: '#fff', strokeWidth: 1 },
                label: { 
                    borderColor: lowColor, 
                    style: { color: '#fff', background: lowColor, fontSize: '9px', padding: { left: 4, right: 4, top: 1, bottom: 1 } }, 
                    text: 'L' + box.Box_ID + ' ' + box.Low_Rate + '% 고점:' + dropFromHigh + '%', 
                    offsetY: 38,
                    position: 'bottom'
                }
            });
        });

        var options = {
            chart: { 
                type: 'line', 
                height: '100%', 
                fontFamily: "'JetBrains Mono', monospace", 
                background: 'transparent', 
                toolbar: { show: true }, 
                zoom: { enabled: true, type: 'xy' },
                events: {
                    mounted: function(chartContext, config) {
                        chartInstance = chartContext;
                        setTimeout(function() { drawBoxRects(chartContext); }, 100);
                    },
                    updated: function(chartContext, config) {
                        setTimeout(function() { drawBoxRects(chartContext); }, 50);
                    },
                    zoomed: function(chartContext, config) {
                        setTimeout(function() { drawBoxRects(chartContext); }, 50);
                    },
                    beforeResetZoom: function(chartContext, config) {
                        setTimeout(function() { drawBoxRects(chartContext); }, 100);
                        return config;
                    },
                    animationEnd: function(chartContext, config) {
                        drawBoxRects(chartContext);
                    },
                    selection: function(chartContext, config) {
                        setTimeout(function() { drawBoxRects(chartContext); }, 50);
                    }
                }
            },
            series: series,
            colors: ['#3B82F6'],
            stroke: { curve: 'smooth', width: 2 },
            grid: { borderColor: 'rgba(255,255,255,0.08)', strokeDashArray: 4 },
            xaxis: { type: 'numeric', min: 420, max: 1471, tickAmount: 10, title: { text: 'Days Since Peak', style: { color: '#94A3B8' } }, labels: { style: { colors: '#94A3B8' } } },
            yaxis: { min: 0, max: 1560, tickAmount: 10, title: { text: 'Rate (% of Peak)', style: { color: '#94A3B8' } }, labels: { style: { colors: '#94A3B8' }, formatter: function(v) { return v + '%'; } } },
            tooltip: { 
                theme: 'dark',
                custom: function({series, seriesIndex, dataPointIndex, w}) {
                    var data = w.globals.initialSeries[seriesIndex].data;
                    var point = data[dataPointIndex];
                    var dayX = point.x;
                    var val = point.y.toFixed(2);
                    var box = getBoxAtPosition(dayX);
                    
                    if (box) {
                        return '<div style="padding:12px; background:' + box.color + '; border-radius:6px; color:#000; font-weight:bold; border:2px solid #fff;">' +
                            'Box ' + box.Box_ID + '<br/>' +
                            '<span style="font-size:14px;">-' + box.Drop_Percent.toFixed(1) + '%</span><br/>' +
                            '<span style="font-size:11px;">Day ' + box.Start_Day + '-' + box.End_Day + ' (' + box.Duration_Days + 'd)</span><br/>' +
                            '<span style="font-size:10px;opacity:0.9;">High: ' + box.Start_Rate + '% → Low: ' + box.Low_Rate + '%</span>' +
                            '</div>';
                    }
                    
                    return '<div style="padding:8px; background:rgba(59,130,246,0.9); border-radius:6px; color:#fff;">' +
                        '<span>Day ' + dayX + '</span><br/>' +
                        '<span style="font-size:12px;">Rate: ' + val + '%</span>' +
                        '</div>';
                }
            },
            annotations: { points: pointAnnotations },
            legend: { show: false }
        };

        var chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();
        
        // 홈 버튼 클릭 감지 (toolbar 버튼 클릭 시 박스 다시 그리기)
        setTimeout(function() {
            var toolbar = document.querySelector('.apexcharts-toolbar');
            if (toolbar) {
                toolbar.addEventListener('click', function(e) {
                    // 홈 버튼 또는 다른 툴바 버튼 클릭 시
                    setTimeout(function() {
                        if (chartInstance) drawBoxRects(chartInstance);
                    }, 300);
                });
            }
            
            // MutationObserver로 차트 변경 감지
            var chartEl = document.querySelector('#chart');
            var observer = new MutationObserver(function(mutations) {
                if (chartInstance) {
                    setTimeout(function() { drawBoxRects(chartInstance); }, 50);
                }
            });
            observer.observe(chartEl, { childList: true, subtree: true });
        }, 500);
    </script>
</body>
</html>