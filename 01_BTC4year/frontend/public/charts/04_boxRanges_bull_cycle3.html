<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cycle 3 Bull - Box Range Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { height: 100%; }
        body { height: 100%; overflow-x: hidden; overflow-y: auto; }
        body { font-family: 'Inter', sans-serif; background: linear-gradient(180deg, #020617 0%, #0F172A 100%); min-height: 100vh; padding: 20px; display: flex; flex-direction: column; }
        .container { flex: 1; display: flex; flex-direction: column; max-width: 1400px; width: 100%; margin: 0 auto; min-height: 0; }
        .chart-wrapper { flex: 1; display: flex; flex-direction: column; background: linear-gradient(135deg, #0F172A 0%, #1E293B 50%, #0F172A 100%); border-radius: 16px; padding: 20px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.05); min-height: 0; }
        .header { flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 12px; }
        .header h2 { font-size: 18px; font-weight: 700; color: #F8FAFC; }
        .header p { font-size: 12px; color: #64748B; margin-top: 4px; }
        #chart { flex: 1; margin: 0 -12px; min-height: 0; }
        .footer { flex-shrink: 0; display: flex; justify-content: center; margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.06); font-size: 11px; color: #64748B; }
        
        /* 모바일 대응 */
        @media (max-width: 768px) {
            body { padding: 12px; }
            .chart-wrapper { padding: 12px; border-radius: 12px; min-height: 450px; }
            .header h2 { font-size: 14px; }
            .header p { font-size: 10px; }
            #chart { margin: 0 -6px; min-height: 350px; }
            .footer { font-size: 9px; margin-top: 8px; padding-top: 8px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="chart-wrapper">
            <div class="header">
                <div>
                    <h2>Cycle 3 Bull (2023.01~2025.10) - Correction Box Range Analysis</h2>
                    <p>Drop ≥5.0%, Breakup &lt;2.0%</p>
                </div>
            </div>
            <div id="chart"></div>
            <div class="footer">Data source: Supabase BTC/USDT OHLCV (Day 420~1427)</div>
        </div>
    </div>
    <script>
        var series = [{"name": "Cycle 3", "data": [{"x": 420, "y": 24.88}, {"x": 421, "y": 24.85}, {"x": 422, "y": 25.16}, {"x": 423, "y": 25.0}, {"x": 424, "y": 25.24}, {"x": 425, "y": 25.15}, {"x": 426, "y": 25.44}, {"x": 427, "y": 25.77}, {"x": 428, "y": 25.91}, {"x": 429, "y": 26.66}, {"x": 430, "y": 28.31}, {"x": 431, "y": 29.62}, {"x": 432, "y": 31.48}, {"x": 433, "y": 31.17}, {"x": 434, "y": 31.8}, {"x": 435, "y": 32.06}, {"x": 436, "y": 32.06}, {"x": 437, "y": 31.38}, {"x": 438, "y": 33.7}, {"x": 439, "y": 34.61}, {"x": 440, "y": 34.18}, {"x": 441, "y": 34.33}, {"x": 442, "y": 34.3}, {"x": 443, "y": 35.27}, {"x": 444, "y": 34.48}, {"x": 445, "y": 34.8}, {"x": 446, "y": 34.34}, {"x": 447, "y": 35.48}, {"x": 448, "y": 35.25}, {"x": 449, "y": 34.53}, {"x": 450, "y": 35.26}, {"x": 451, "y": 35.92}, {"x": 452, "y": 35.12}, {"x": 453, "y": 34.93}, {"x": 454, "y": 34.7}, {"x": 455, "y": 34.3}, {"x": 456, "y": 34.58}, {"x": 457, "y": 34.73}, {"x": 458, "y": 34.08}, {"x": 459, "y": 32.49}, {"x": 460, "y": 32.44}, {"x": 461, "y": 32.71}, {"x": 462, "y": 32.42}, {"x": 463, "y": 33.05}, {"x": 464, "y": 36.1}, {"x": 465, "y": 37.39}, {"x": 466, "y": 37.05}, {"x": 467, "y": 36.84}, {"x": 468, "y": 37.31}, {"x": 469, "y": 37.2}, {"x": 470, "y": 37.39}, {"x": 471, "y": 36.25}, {"x": 472, "y": 36.43}, {"x": 473, "y": 35.74}, {"x": 474, "y": 34.39}, {"x": 475, "y": 35.08}, {"x": 476, "y": 35.39}, {"x": 477, "y": 34.95}, {"x": 478, "y": 35.54}, {"x": 479, "y": 35.24}, {"x": 480, "y": 34.77}, {"x": 481, "y": 33.19}, {"x": 482, "y": 33.56}, {"x": 483, "y": 33.47}, {"x": 484, "y": 33.41}, {"x": 485, "y": 33.01}, {"x": 486, "y": 32.34}, {"x": 487, "y": 30.16}, {"x": 488, "y": 30.63}, {"x": 489, "y": 32.8}, {"x": 490, "y": 36.28}, {"x": 491, "y": 39.08}, {"x": 492, "y": 37.31}, {"x": 493, "y": 37.27}, {"x": 494, "y": 41.11}, {"x": 495, "y": 41.06}, {"x": 496, "y": 42.04}, {"x": 497, "y": 42.16}, {"x": 498, "y": 42.12}, {"x": 499, "y": 42.75}, {"x": 500, "y": 42.58}, {"x": 501, "y": 42.02}, {"x": 502, "y": 41.15}, {"x": 503, "y": 41.75}, {"x": 504, "y": 41.5}, {"x": 505, "y": 40.75}, {"x": 506, "y": 42.43}, {"x": 507, "y": 43.22}, {"x": 508, "y": 42.44}, {"x": 509, "y": 42.68}, {"x": 510, "y": 42.25}, {"x": 511, "y": 42.21}, {"x": 512, "y": 42.12}, {"x": 513, "y": 42.61}, {"x": 514, "y": 41.74}, {"x": 515, "y": 41.61}, {"x": 516, "y": 41.7}, {"x": 517, "y": 42.25}, {"x": 518, "y": 44.09}, {"x": 519, "y": 45.24}, {"x": 520, "y": 45.15}, {"x": 521, "y": 45.31}, {"x": 522, "y": 45.91}, {"x": 523, "y": 45.31}, {"x": 524, "y": 45.24}, {"x": 525, "y": 44.9}, {"x": 526, "y": 45.15}, {"x": 527, "y": 45.04}, {"x": 528, "y": 43.08}, {"x": 529, "y": 42.02}, {"x": 530, "y": 41.29}, {"x": 531, "y": 41.19}, {"x": 532, "y": 41.47}, {"x": 533, "y": 42.06}, {"x": 534, "y": 44.48}, {"x": 535, "y": 44.26}, {"x": 536, "y": 43.83}, {"x": 537, "y": 43.61}, {"x": 538, "y": 44.38}, {"x": 539, "y": 43.45}, {"x": 540, "y": 42.77}, {"x": 541, "y": 43.34}, {"x": 542, "y": 43.51}, {"x": 543, "y": 43.95}, {"x": 544, "y": 44.16}, {"x": 545, "y": 43.15}, {"x": 546, "y": 42.4}, {"x": 547, "y": 41.2}, {"x": 548, "y": 41.96}, {"x": 549, "y": 40.92}, {"x": 550, "y": 40.12}, {"x": 551, "y": 40.05}, {"x": 552, "y": 40.28}, {"x": 553, "y": 40.97}, {"x": 554, "y": 40.42}, {"x": 555, "y": 40.73}, {"x": 556, "y": 40.7}, {"x": 557, "y": 40.26}, {"x": 558, "y": 40.21}, {"x": 559, "y": 40.4}, {"x": 560, "y": 40.13}, {"x": 561, "y": 40.72}, {"x": 562, "y": 40.31}, {"x": 563, "y": 39.44}, {"x": 564, "y": 39.88}, {"x": 565, "y": 39.83}, {"x": 566, "y": 41.85}, {"x": 567, "y": 42.13}, {"x": 568, "y": 41.52}, {"x": 569, "y": 41.22}, {"x": 570, "y": 40.5}, {"x": 571, "y": 40.43}, {"x": 572, "y": 40.48}, {"x": 573, "y": 40.66}, {"x": 574, "y": 40.18}, {"x": 575, "y": 40.51}, {"x": 576, "y": 40.56}, {"x": 577, "y": 39.7}, {"x": 578, "y": 39.66}, {"x": 579, "y": 39.29}, {"x": 580, "y": 38.81}, {"x": 581, "y": 38.66}, {"x": 582, "y": 39.15}, {"x": 583, "y": 38.65}, {"x": 584, "y": 38.15}, {"x": 585, "y": 39.27}, {"x": 586, "y": 39.75}, {"x": 587, "y": 39.54}, {"x": 588, "y": 40.09}, {"x": 589, "y": 42.06}, {"x": 590, "y": 45.61}, {"x": 591, "y": 45.17}, {"x": 592, "y": 46.55}, {"x": 593, "y": 45.61}, {"x": 594, "y": 45.98}, {"x": 595, "y": 45.41}, {"x": 596, "y": 45.9}, {"x": 597, "y": 45.48}, {"x": 598, "y": 45.68}, {"x": 599, "y": 46.33}, {"x": 600, "y": 45.41}, {"x": 601, "y": 45.6}, {"x": 602, "y": 46.47}, {"x": 603, "y": 46.43}, {"x": 604, "y": 45.73}, {"x": 605, "y": 46.65}, {"x": 606, "y": 45.09}, {"x": 607, "y": 45.0}, {"x": 608, "y": 45.09}, {"x": 609, "y": 45.98}, {"x": 610, "y": 45.63}, {"x": 611, "y": 45.88}, {"x": 612, "y": 47.1}, {"x": 613, "y": 46.84}, {"x": 614, "y": 45.01}, {"x": 615, "y": 45.08}, {"x": 616, "y": 44.93}, {"x": 617, "y": 44.78}, {"x": 618, "y": 44.71}, {"x": 619, "y": 45.05}, {"x": 620, "y": 44.52}, {"x": 621, "y": 44.43}, {"x": 622, "y": 44.95}, {"x": 623, "y": 44.57}, {"x": 624, "y": 43.5}, {"x": 625, "y": 43.97}, {"x": 626, "y": 43.79}, {"x": 627, "y": 43.75}, {"x": 628, "y": 43.55}, {"x": 629, "y": 43.61}, {"x": 630, "y": 43.73}, {"x": 631, "y": 44.04}, {"x": 632, "y": 44.5}, {"x": 633, "y": 43.59}, {"x": 634, "y": 43.44}, {"x": 635, "y": 43.17}, {"x": 636, "y": 43.25}, {"x": 637, "y": 43.36}, {"x": 638, "y": 44.79}, {"x": 639, "y": 44.66}, {"x": 640, "y": 44.04}, {"x": 641, "y": 43.78}, {"x": 642, "y": 43.66}, {"x": 643, "y": 43.65}, {"x": 644, "y": 43.98}, {"x": 645, "y": 43.69}, {"x": 646, "y": 43.33}, {"x": 647, "y": 42.63}, {"x": 648, "y": 39.74}, {"x": 649, "y": 38.92}, {"x": 650, "y": 38.95}, {"x": 651, "y": 38.89}, {"x": 652, "y": 38.71}, {"x": 653, "y": 39.72}, {"x": 654, "y": 39.36}, {"x": 655, "y": 38.97}, {"x": 656, "y": 38.69}, {"x": 657, "y": 38.77}, {"x": 658, "y": 38.88}, {"x": 659, "y": 41.68}, {"x": 660, "y": 41.12}, {"x": 661, "y": 40.85}, {"x": 662, "y": 38.73}, {"x": 663, "y": 38.49}, {"x": 664, "y": 38.7}, {"x": 665, "y": 38.66}, {"x": 666, "y": 38.38}, {"x": 667, "y": 38.56}, {"x": 668, "y": 39.16}, {"x": 669, "y": 39.16}, {"x": 670, "y": 38.42}, {"x": 671, "y": 38.55}, {"x": 672, "y": 38.36}, {"x": 673, "y": 39.34}, {"x": 674, "y": 39.1}, {"x": 675, "y": 39.78}, {"x": 676, "y": 39.82}, {"x": 677, "y": 39.65}, {"x": 678, "y": 39.43}, {"x": 679, "y": 40.59}, {"x": 680, "y": 40.7}, {"x": 681, "y": 40.56}, {"x": 682, "y": 40.22}, {"x": 683, "y": 39.6}, {"x": 684, "y": 39.44}, {"x": 685, "y": 39.6}, {"x": 686, "y": 39.16}, {"x": 687, "y": 39.09}, {"x": 688, "y": 39.76}, {"x": 689, "y": 40.44}, {"x": 690, "y": 40.35}, {"x": 691, "y": 40.13}, {"x": 692, "y": 41.56}, {"x": 693, "y": 42.32}, {"x": 694, "y": 40.99}, {"x": 695, "y": 41.23}, {"x": 696, "y": 41.64}, {"x": 697, "y": 41.9}, {"x": 698, "y": 41.51}, {"x": 699, "y": 41.61}, {"x": 700, "y": 41.45}, {"x": 701, "y": 41.07}, {"x": 702, "y": 40.69}, {"x": 703, "y": 39.91}, {"x": 704, "y": 40.18}, {"x": 705, "y": 39.97}, {"x": 706, "y": 40.42}, {"x": 707, "y": 44.43}, {"x": 708, "y": 42.37}, {"x": 709, "y": 42.92}, {"x": 710, "y": 42.82}, {"x": 711, "y": 44.73}, {"x": 712, "y": 44.99}, {"x": 713, "y": 44.79}, {"x": 714, "y": 51.45}, {"x": 715, "y": 52.25}, {"x": 716, "y": 52.03}, {"x": 717, "y": 51.57}, {"x": 718, "y": 50.71}, {"x": 719, "y": 51.08}, {"x": 720, "y": 51.46}, {"x": 721, "y": 51.62}, {"x": 722, "y": 51.42}, {"x": 723, "y": 52.69}, {"x": 724, "y": 53.29}, {"x": 725, "y": 51.75}, {"x": 726, "y": 52.21}, {"x": 727, "y": 52.39}, {"x": 728, "y": 52.24}, {"x": 729, "y": 53.15}, {"x": 730, "y": 53.47}, {"x": 731, "y": 56.23}, {"x": 732, "y": 55.57}, {"x": 733, "y": 55.4}, {"x": 734, "y": 55.12}, {"x": 735, "y": 55.41}, {"x": 736, "y": 54.41}, {"x": 737, "y": 56.25}, {"x": 738, "y": 56.17}, {"x": 739, "y": 54.5}, {"x": 740, "y": 54.57}, {"x": 741, "y": 55.53}, {"x": 742, "y": 55.9}, {"x": 743, "y": 55.76}, {"x": 744, "y": 56.07}, {"x": 745, "y": 55.76}, {"x": 746, "y": 56.89}, {"x": 747, "y": 56.11}, {"x": 748, "y": 56.0}, {"x": 749, "y": 55.64}, {"x": 750, "y": 56.83}, {"x": 751, "y": 56.94}, {"x": 752, "y": 56.49}, {"x": 753, "y": 57.75}, {"x": 754, "y": 58.82}, {"x": 755, "y": 59.61}, {"x": 756, "y": 62.82}, {"x": 757, "y": 65.88}, {"x": 758, "y": 65.6}, {"x": 759, "y": 65.23}, {"x": 760, "y": 66.2}, {"x": 761, "y": 65.69}, {"x": 762, "y": 65.23}, {"x": 763, "y": 64.87}, {"x": 764, "y": 62.35}, {"x": 765, "y": 64.38}, {"x": 766, "y": 64.3}, {"x": 767, "y": 63.8}, {"x": 768, "y": 63.27}, {"x": 769, "y": 62.83}, {"x": 770, "y": 63.32}, {"x": 771, "y": 64.42}, {"x": 772, "y": 65.58}, {"x": 773, "y": 65.52}, {"x": 774, "y": 65.75}, {"x": 775, "y": 65.14}, {"x": 776, "y": 65.08}, {"x": 777, "y": 64.87}, {"x": 778, "y": 64.56}, {"x": 779, "y": 64.68}, {"x": 780, "y": 64.85}, {"x": 781, "y": 63.84}, {"x": 782, "y": 63.11}, {"x": 783, "y": 63.53}, {"x": 784, "y": 65.43}, {"x": 785, "y": 67.94}, {"x": 786, "y": 67.38}, {"x": 787, "y": 66.24}, {"x": 788, "y": 65.69}, {"x": 789, "y": 65.48}, {"x": 790, "y": 65.87}, {"x": 791, "y": 69.97}, {"x": 792, "y": 71.04}, {"x": 793, "y": 70.63}, {"x": 794, "y": 72.52}, {"x": 795, "y": 68.89}, {"x": 796, "y": 64.06}, {"x": 797, "y": 63.8}, {"x": 798, "y": 64.27}, {"x": 799, "y": 64.54}, {"x": 800, "y": 63.97}, {"x": 801, "y": 63.58}, {"x": 802, "y": 62.49}, {"x": 803, "y": 62.01}, {"x": 804, "y": 62.02}, {"x": 805, "y": 61.74}, {"x": 806, "y": 59.5}, {"x": 807, "y": 60.06}, {"x": 808, "y": 59.68}, {"x": 809, "y": 62.56}, {"x": 810, "y": 62.49}, {"x": 811, "y": 63.45}, {"x": 812, "y": 64.17}, {"x": 813, "y": 64.99}, {"x": 814, "y": 64.78}, {"x": 815, "y": 64.1}, {"x": 816, "y": 64.4}, {"x": 817, "y": 64.24}, {"x": 818, "y": 63.86}, {"x": 819, "y": 64.52}, {"x": 820, "y": 64.27}, {"x": 821, "y": 65.75}, {"x": 822, "y": 67.55}, {"x": 823, "y": 71.38}, {"x": 824, "y": 71.34}, {"x": 825, "y": 71.96}, {"x": 826, "y": 74.54}, {"x": 827, "y": 74.59}, {"x": 828, "y": 77.07}, {"x": 829, "y": 78.22}, {"x": 830, "y": 77.85}, {"x": 831, "y": 77.25}, {"x": 832, "y": 77.57}, {"x": 833, "y": 77.73}, {"x": 834, "y": 78.47}, {"x": 835, "y": 77.55}, {"x": 836, "y": 77.1}, {"x": 837, "y": 76.34}, {"x": 838, "y": 76.56}, {"x": 839, "y": 76.95}, {"x": 840, "y": 81.32}, {"x": 841, "y": 85.28}, {"x": 842, "y": 94.78}, {"x": 843, "y": 94.3}, {"x": 844, "y": 93.47}, {"x": 845, "y": 92.46}, {"x": 846, "y": 93.64}, {"x": 847, "y": 101.44}, {"x": 848, "y": 102.18}, {"x": 849, "y": 100.17}, {"x": 850, "y": 100.67}, {"x": 851, "y": 103.65}, {"x": 852, "y": 101.5}, {"x": 853, "y": 103.5}, {"x": 854, "y": 107.81}, {"x": 855, "y": 108.11}, {"x": 856, "y": 109.07}, {"x": 857, "y": 109.26}, {"x": 858, "y": 107.25}, {"x": 859, "y": 103.73}, {"x": 860, "y": 102.04}, {"x": 861, "y": 102.12}, {"x": 862, "y": 100.89}, {"x": 863, "y": 100.85}, {"x": 864, "y": 101.06}, {"x": 865, "y": 98.7}, {"x": 866, "y": 97.74}, {"x": 867, "y": 100.15}, {"x": 868, "y": 105.37}, {"x": 869, "y": 105.98}, {"x": 870, "y": 106.28}, {"x": 871, "y": 105.96}, {"x": 872, "y": 105.02}, {"x": 873, "y": 104.14}, {"x": 874, "y": 105.69}, {"x": 875, "y": 105.57}, {"x": 876, "y": 103.18}, {"x": 877, "y": 99.08}, {"x": 878, "y": 102.64}, {"x": 879, "y": 101.82}, {"x": 880, "y": 103.21}, {"x": 881, "y": 104.15}, {"x": 882, "y": 107.81}, {"x": 883, "y": 106.27}, {"x": 884, "y": 105.4}, {"x": 885, "y": 105.6}, {"x": 886, "y": 105.48}, {"x": 887, "y": 100.6}, {"x": 888, "y": 97.5}, {"x": 889, "y": 99.02}, {"x": 890, "y": 95.32}, {"x": 891, "y": 95.52}, {"x": 892, "y": 94.95}, {"x": 893, "y": 96.93}, {"x": 894, "y": 96.88}, {"x": 895, "y": 97.29}, {"x": 896, "y": 99.57}, {"x": 897, "y": 99.49}, {"x": 898, "y": 99.33}, {"x": 899, "y": 96.7}, {"x": 900, "y": 95.99}, {"x": 901, "y": 94.67}, {"x": 902, "y": 95.33}, {"x": 903, "y": 95.12}, {"x": 904, "y": 95.87}, {"x": 905, "y": 90.1}, {"x": 906, "y": 88.3}, {"x": 907, "y": 93.79}, {"x": 908, "y": 95.58}, {"x": 909, "y": 95.74}, {"x": 910, "y": 97.0}, {"x": 911, "y": 95.4}, {"x": 912, "y": 93.33}, {"x": 913, "y": 93.93}, {"x": 914, "y": 93.99}, {"x": 915, "y": 91.1}, {"x": 916, "y": 91.65}, {"x": 917, "y": 93.96}, {"x": 918, "y": 93.47}, {"x": 919, "y": 98.4}, {"x": 920, "y": 98.85}, {"x": 921, "y": 99.89}, {"x": 922, "y": 99.81}, {"x": 923, "y": 100.26}, {"x": 924, "y": 105.91}, {"x": 925, "y": 106.59}, {"x": 926, "y": 104.65}, {"x": 927, "y": 103.81}, {"x": 928, "y": 102.55}, {"x": 929, "y": 103.09}, {"x": 930, "y": 103.02}, {"x": 931, "y": 104.68}, {"x": 932, "y": 103.06}, {"x": 933, "y": 102.09}, {"x": 934, "y": 102.92}, {"x": 935, "y": 102.25}, {"x": 936, "y": 100.55}, {"x": 937, "y": 101.38}, {"x": 938, "y": 104.09}, {"x": 939, "y": 105.24}, {"x": 940, "y": 106.27}, {"x": 941, "y": 106.18}, {"x": 942, "y": 106.62}, {"x": 943, "y": 103.05}, {"x": 944, "y": 103.45}, {"x": 945, "y": 103.95}, {"x": 946, "y": 103.06}, {"x": 947, "y": 103.66}, {"x": 948, "y": 101.37}, {"x": 949, "y": 99.77}, {"x": 950, "y": 98.45}, {"x": 951, "y": 99.22}, {"x": 952, "y": 99.66}, {"x": 953, "y": 98.61}, {"x": 954, "y": 97.34}, {"x": 955, "y": 98.46}, {"x": 956, "y": 96.36}, {"x": 957, "y": 95.59}, {"x": 958, "y": 95.55}, {"x": 959, "y": 93.85}, {"x": 960, "y": 92.44}, {"x": 961, "y": 92.54}, {"x": 962, "y": 92.39}, {"x": 963, "y": 92.15}, {"x": 964, "y": 90.67}, {"x": 965, "y": 93.38}, {"x": 966, "y": 94.57}, {"x": 967, "y": 93.73}, {"x": 968, "y": 92.24}, {"x": 969, "y": 89.59}, {"x": 970, "y": 85.22}, {"x": 971, "y": 86.6}, {"x": 972, "y": 86.56}, {"x": 973, "y": 86.24}, {"x": 974, "y": 86.33}, {"x": 975, "y": 88.07}, {"x": 976, "y": 88.34}, {"x": 977, "y": 86.67}, {"x": 978, "y": 88.63}, {"x": 979, "y": 90.96}, {"x": 980, "y": 96.11}, {"x": 981, "y": 96.84}, {"x": 982, "y": 97.93}, {"x": 983, "y": 96.46}, {"x": 984, "y": 99.79}, {"x": 985, "y": 100.11}, {"x": 986, "y": 101.25}, {"x": 987, "y": 101.4}, {"x": 988, "y": 100.33}, {"x": 989, "y": 99.37}, {"x": 990, "y": 98.0}, {"x": 991, "y": 101.0}, {"x": 992, "y": 102.78}, {"x": 993, "y": 101.17}, {"x": 994, "y": 103.78}, {"x": 995, "y": 99.22}, {"x": 996, "y": 99.0}, {"x": 997, "y": 97.24}, {"x": 998, "y": 97.14}, {"x": 999, "y": 92.11}, {"x": 1000, "y": 90.51}, {"x": 1001, "y": 86.35}, {"x": 1002, "y": 84.47}, {"x": 1003, "y": 85.5}, {"x": 1004, "y": 92.92}, {"x": 1005, "y": 91.44}, {"x": 1006, "y": 91.03}, {"x": 1007, "y": 91.61}, {"x": 1008, "y": 89.91}, {"x": 1009, "y": 91.19}, {"x": 1010, "y": 91.52}, {"x": 1011, "y": 88.63}, {"x": 1012, "y": 88.59}, {"x": 1013, "y": 88.41}, {"x": 1014, "y": 89.28}, {"x": 1015, "y": 88.29}, {"x": 1016, "y": 90.93}, {"x": 1017, "y": 91.55}, {"x": 1018, "y": 90.93}, {"x": 1019, "y": 96.19}, {"x": 1020, "y": 95.51}, {"x": 1021, "y": 96.26}, {"x": 1022, "y": 95.49}, {"x": 1023, "y": 93.61}, {"x": 1024, "y": 89.2}, {"x": 1025, "y": 90.58}, {"x": 1026, "y": 88.77}, {"x": 1027, "y": 88.06}, {"x": 1028, "y": 87.49}, {"x": 1029, "y": 88.0}, {"x": 1030, "y": 88.57}, {"x": 1031, "y": 86.66}, {"x": 1032, "y": 86.38}, {"x": 1033, "y": 84.42}, {"x": 1034, "y": 81.23}, {"x": 1035, "y": 81.92}, {"x": 1036, "y": 86.02}, {"x": 1037, "y": 85.96}, {"x": 1038, "y": 85.87}, {"x": 1039, "y": 86.76}, {"x": 1040, "y": 89.78}, {"x": 1041, "y": 89.76}, {"x": 1042, "y": 89.44}, {"x": 1043, "y": 87.69}, {"x": 1044, "y": 90.81}, {"x": 1045, "y": 91.5}, {"x": 1046, "y": 94.56}, {"x": 1047, "y": 94.98}, {"x": 1048, "y": 94.13}, {"x": 1049, "y": 94.78}, {"x": 1050, "y": 95.88}, {"x": 1051, "y": 95.8}, {"x": 1052, "y": 95.99}, {"x": 1053, "y": 97.5}, {"x": 1054, "y": 98.48}, {"x": 1055, "y": 98.13}, {"x": 1056, "y": 97.85}, {"x": 1057, "y": 97.18}, {"x": 1058, "y": 94.97}, {"x": 1059, "y": 92.39}, {"x": 1060, "y": 91.04}, {"x": 1061, "y": 92.53}, {"x": 1062, "y": 92.37}, {"x": 1063, "y": 93.26}, {"x": 1064, "y": 95.49}, {"x": 1065, "y": 93.59}, {"x": 1066, "y": 92.62}, {"x": 1067, "y": 90.81}, {"x": 1068, "y": 93.92}, {"x": 1069, "y": 94.01}, {"x": 1070, "y": 93.72}, {"x": 1071, "y": 98.48}, {"x": 1072, "y": 100.63}, {"x": 1073, "y": 101.33}, {"x": 1074, "y": 100.61}, {"x": 1075, "y": 102.18}, {"x": 1076, "y": 101.73}, {"x": 1077, "y": 102.78}, {"x": 1078, "y": 102.95}, {"x": 1079, "y": 100.46}, {"x": 1080, "y": 99.92}, {"x": 1081, "y": 101.96}, {"x": 1082, "y": 101.84}, {"x": 1083, "y": 99.89}, {"x": 1084, "y": 101.19}, {"x": 1085, "y": 104.06}, {"x": 1086, "y": 109.03}, {"x": 1087, "y": 108.05}, {"x": 1088, "y": 107.66}, {"x": 1089, "y": 106.08}, {"x": 1090, "y": 103.54}, {"x": 1091, "y": 102.76}, {"x": 1092, "y": 102.92}, {"x": 1093, "y": 104.52}, {"x": 1094, "y": 113.14}, {"x": 1095, "y": 113.81}, {"x": 1096, "y": 114.33}, {"x": 1097, "y": 113.88}, {"x": 1098, "y": 120.69}, {"x": 1099, "y": 132.59}, {"x": 1100, "y": 133.19}, {"x": 1101, "y": 138.12}, {"x": 1102, "y": 135.93}, {"x": 1103, "y": 136.02}, {"x": 1104, "y": 135.92}, {"x": 1105, "y": 135.43}, {"x": 1106, "y": 137.12}, {"x": 1107, "y": 139.07}, {"x": 1108, "y": 140.44}, {"x": 1109, "y": 146.59}, {"x": 1110, "y": 147.48}, {"x": 1111, "y": 146.48}, {"x": 1112, "y": 145.96}, {"x": 1113, "y": 146.42}, {"x": 1114, "y": 140.65}, {"x": 1115, "y": 143.96}, {"x": 1116, "y": 143.0}, {"x": 1117, "y": 146.05}, {"x": 1118, "y": 144.34}, {"x": 1119, "y": 144.89}, {"x": 1120, "y": 145.32}, {"x": 1121, "y": 142.62}, {"x": 1122, "y": 146.61}, {"x": 1123, "y": 154.15}, {"x": 1124, "y": 150.9}, {"x": 1125, "y": 148.74}, {"x": 1126, "y": 150.09}, {"x": 1127, "y": 149.89}, {"x": 1128, "y": 145.53}, {"x": 1129, "y": 150.89}, {"x": 1130, "y": 151.85}, {"x": 1131, "y": 150.9}, {"x": 1132, "y": 152.02}, {"x": 1133, "y": 155.87}, {"x": 1134, "y": 159.63}, {"x": 1135, "y": 160.46}, {"x": 1136, "y": 157.75}, {"x": 1137, "y": 152.24}, {"x": 1138, "y": 145.47}, {"x": 1139, "y": 147.41}, {"x": 1140, "y": 144.31}, {"x": 1141, "y": 142.97}, {"x": 1142, "y": 147.33}, {"x": 1143, "y": 147.45}, {"x": 1144, "y": 148.04}, {"x": 1145, "y": 144.46}, {"x": 1146, "y": 141.77}, {"x": 1147, "y": 141.19}, {"x": 1148, "y": 140.72}, {"x": 1149, "y": 142.54}, {"x": 1150, "y": 140.91}, {"x": 1151, "y": 144.89}, {"x": 1152, "y": 146.58}, {"x": 1153, "y": 146.28}, {"x": 1154, "y": 146.37}, {"x": 1155, "y": 151.76}, {"x": 1156, "y": 152.13}, {"x": 1157, "y": 144.05}, {"x": 1158, "y": 141.25}, {"x": 1159, "y": 141.92}, {"x": 1160, "y": 140.76}, {"x": 1161, "y": 141.35}, {"x": 1162, "y": 142.08}, {"x": 1163, "y": 144.2}, {"x": 1164, "y": 149.1}, {"x": 1165, "y": 149.37}, {"x": 1166, "y": 156.78}, {"x": 1167, "y": 155.48}, {"x": 1168, "y": 157.6}, {"x": 1169, "y": 162.29}, {"x": 1170, "y": 158.81}, {"x": 1171, "y": 157.56}, {"x": 1172, "y": 158.24}, {"x": 1173, "y": 158.64}, {"x": 1174, "y": 155.92}, {"x": 1175, "y": 156.24}, {"x": 1176, "y": 152.92}, {"x": 1177, "y": 153.72}, {"x": 1178, "y": 155.17}, {"x": 1179, "y": 157.65}, {"x": 1180, "y": 156.99}, {"x": 1181, "y": 152.21}, {"x": 1182, "y": 150.25}, {"x": 1183, "y": 151.79}, {"x": 1184, "y": 150.66}, {"x": 1185, "y": 146.83}, {"x": 1186, "y": 146.79}, {"x": 1187, "y": 148.3}, {"x": 1188, "y": 143.47}, {"x": 1189, "y": 144.13}, {"x": 1190, "y": 145.64}, {"x": 1191, "y": 145.84}, {"x": 1192, "y": 145.31}, {"x": 1193, "y": 145.25}, {"x": 1194, "y": 146.35}, {"x": 1195, "y": 145.09}, {"x": 1196, "y": 144.69}, {"x": 1197, "y": 143.72}, {"x": 1198, "y": 143.28}, {"x": 1199, "y": 143.5}, {"x": 1200, "y": 146.18}, {"x": 1201, "y": 147.31}, {"x": 1202, "y": 143.62}, {"x": 1203, "y": 143.13}, {"x": 1204, "y": 142.91}, {"x": 1205, "y": 137.04}, {"x": 1206, "y": 132.41}, {"x": 1207, "y": 128.96}, {"x": 1208, "y": 126.06}, {"x": 1209, "y": 128.19}, {"x": 1210, "y": 140.69}, {"x": 1211, "y": 139.82}, {"x": 1212, "y": 131.75}, {"x": 1213, "y": 134.76}, {"x": 1214, "y": 137.44}, {"x": 1215, "y": 135.18}, {"x": 1216, "y": 128.69}, {"x": 1217, "y": 128.1}, {"x": 1218, "y": 124.58}, {"x": 1219, "y": 123.83}, {"x": 1220, "y": 125.2}, {"x": 1221, "y": 124.89}, {"x": 1222, "y": 126.34}, {"x": 1223, "y": 125.4}, {"x": 1224, "y": 126.05}, {"x": 1225, "y": 125.52}, {"x": 1226, "y": 124.43}, {"x": 1227, "y": 128.84}, {"x": 1228, "y": 129.51}, {"x": 1229, "y": 125.66}, {"x": 1230, "y": 125.2}, {"x": 1231, "y": 127.55}, {"x": 1232, "y": 131.45}, {"x": 1233, "y": 131.12}, {"x": 1234, "y": 130.73}, {"x": 1235, "y": 129.96}, {"x": 1236, "y": 129.6}, {"x": 1237, "y": 125.32}, {"x": 1238, "y": 123.71}, {"x": 1239, "y": 124.31}, {"x": 1240, "y": 126.74}, {"x": 1241, "y": 131.06}, {"x": 1242, "y": 124.39}, {"x": 1243, "y": 125.46}, {"x": 1244, "y": 124.79}, {"x": 1245, "y": 124.13}, {"x": 1246, "y": 120.31}, {"x": 1247, "y": 119.76}, {"x": 1248, "y": 123.79}, {"x": 1249, "y": 122.55}, {"x": 1250, "y": 124.84}, {"x": 1251, "y": 127.22}, {"x": 1252, "y": 127.51}, {"x": 1253, "y": 127.06}, {"x": 1254, "y": 128.09}, {"x": 1255, "y": 126.62}, {"x": 1256, "y": 126.57}, {"x": 1257, "y": 126.07}, {"x": 1258, "y": 126.88}, {"x": 1259, "y": 126.35}, {"x": 1260, "y": 131.01}, {"x": 1261, "y": 139.04}, {"x": 1262, "y": 140.24}, {"x": 1263, "y": 139.21}, {"x": 1264, "y": 141.81}, {"x": 1265, "y": 140.98}, {"x": 1266, "y": 141.23}, {"x": 1267, "y": 141.62}, {"x": 1268, "y": 141.37}, {"x": 1269, "y": 141.03}, {"x": 1270, "y": 144.28}, {"x": 1271, "y": 144.98}, {"x": 1272, "y": 143.55}, {"x": 1273, "y": 142.62}, {"x": 1274, "y": 140.98}, {"x": 1275, "y": 143.53}, {"x": 1276, "y": 144.73}, {"x": 1277, "y": 154.23}, {"x": 1278, "y": 154.55}, {"x": 1279, "y": 155.47}, {"x": 1280, "y": 155.45}, {"x": 1281, "y": 156.71}, {"x": 1282, "y": 155.46}, {"x": 1283, "y": 154.54}, {"x": 1284, "y": 154.3}, {"x": 1285, "y": 154.83}, {"x": 1286, "y": 153.59}, {"x": 1287, "y": 157.95}, {"x": 1288, "y": 158.62}, {"x": 1289, "y": 158.93}, {"x": 1290, "y": 164.08}, {"x": 1291, "y": 165.83}, {"x": 1292, "y": 165.57}, {"x": 1293, "y": 162.17}, {"x": 1294, "y": 161.86}, {"x": 1295, "y": 163.53}, {"x": 1296, "y": 163.96}, {"x": 1297, "y": 161.84}, {"x": 1298, "y": 161.26}, {"x": 1299, "y": 157.44}, {"x": 1300, "y": 155.35}, {"x": 1301, "y": 156.78}, {"x": 1302, "y": 156.88}, {"x": 1303, "y": 158.15}, {"x": 1304, "y": 156.98}, {"x": 1305, "y": 156.84}, {"x": 1306, "y": 155.99}, {"x": 1307, "y": 156.83}, {"x": 1308, "y": 157.7}, {"x": 1309, "y": 163.69}, {"x": 1310, "y": 163.49}, {"x": 1311, "y": 163.48}, {"x": 1312, "y": 161.14}, {"x": 1313, "y": 157.24}, {"x": 1314, "y": 157.35}, {"x": 1315, "y": 157.17}, {"x": 1316, "y": 161.35}, {"x": 1317, "y": 159.6}, {"x": 1318, "y": 156.31}, {"x": 1319, "y": 155.83}, {"x": 1320, "y": 157.75}, {"x": 1321, "y": 153.99}, {"x": 1322, "y": 153.13}, {"x": 1323, "y": 157.09}, {"x": 1324, "y": 157.41}, {"x": 1325, "y": 160.14}, {"x": 1326, "y": 160.34}, {"x": 1327, "y": 159.55}, {"x": 1328, "y": 159.31}, {"x": 1329, "y": 160.72}, {"x": 1330, "y": 161.11}, {"x": 1331, "y": 159.26}, {"x": 1332, "y": 162.5}, {"x": 1333, "y": 163.68}, {"x": 1334, "y": 162.56}, {"x": 1335, "y": 160.56}, {"x": 1336, "y": 162.46}, {"x": 1337, "y": 162.46}, {"x": 1338, "y": 161.74}, {"x": 1339, "y": 165.86}, {"x": 1340, "y": 173.07}, {"x": 1341, "y": 176.04}, {"x": 1342, "y": 175.04}, {"x": 1343, "y": 176.95}, {"x": 1344, "y": 182.48}, {"x": 1345, "y": 177.62}, {"x": 1346, "y": 177.8}, {"x": 1347, "y": 179.19}, {"x": 1348, "y": 178.93}, {"x": 1349, "y": 175.49}, {"x": 1350, "y": 176.02}, {"x": 1351, "y": 177.23}, {"x": 1352, "y": 178.08}, {"x": 1353, "y": 177.84}, {"x": 1354, "y": 176.9}, {"x": 1355, "y": 175.42}, {"x": 1356, "y": 175.19}, {"x": 1357, "y": 177.36}, {"x": 1358, "y": 177.41}, {"x": 1359, "y": 176.63}, {"x": 1360, "y": 175.92}, {"x": 1361, "y": 176.11}, {"x": 1362, "y": 171.86}, {"x": 1363, "y": 168.92}, {"x": 1364, "y": 170.01}, {"x": 1365, "y": 171.37}, {"x": 1366, "y": 170.49}, {"x": 1367, "y": 171.37}, {"x": 1368, "y": 174.19}, {"x": 1369, "y": 174.2}, {"x": 1370, "y": 174.67}, {"x": 1371, "y": 176.69}, {"x": 1372, "y": 181.17}, {"x": 1373, "y": 178.19}, {"x": 1374, "y": 183.14}, {"x": 1375, "y": 184.34}, {"x": 1376, "y": 176.55}, {"x": 1377, "y": 174.6}, {"x": 1378, "y": 175.6}, {"x": 1379, "y": 174.07}, {"x": 1380, "y": 172.86}, {"x": 1381, "y": 169.74}, {"x": 1382, "y": 170.04}, {"x": 1383, "y": 173.9}, {"x": 1384, "y": 173.31}, {"x": 1385, "y": 171.29}, {"x": 1386, "y": 168.33}, {"x": 1387, "y": 166.41}, {"x": 1388, "y": 166.79}, {"x": 1389, "y": 168.06}, {"x": 1390, "y": 166.81}, {"x": 1391, "y": 161.31}, {"x": 1392, "y": 162.13}, {"x": 1393, "y": 162.77}, {"x": 1394, "y": 165.52}, {"x": 1395, "y": 166.71}, {"x": 1396, "y": 166.13}, {"x": 1397, "y": 167.91}, {"x": 1398, "y": 164.84}, {"x": 1399, "y": 165.27}, {"x": 1400, "y": 167.23}, {"x": 1401, "y": 167.78}, {"x": 1402, "y": 169.29}, {"x": 1403, "y": 171.03}, {"x": 1404, "y": 172.77}, {"x": 1405, "y": 172.23}, {"x": 1406, "y": 172.03}, {"x": 1407, "y": 172.91}, {"x": 1408, "y": 173.21}, {"x": 1409, "y": 173.69}, {"x": 1410, "y": 174.6}, {"x": 1411, "y": 173.95}, {"x": 1412, "y": 171.97}, {"x": 1413, "y": 171.52}, {"x": 1414, "y": 170.87}, {"x": 1415, "y": 167.77}, {"x": 1416, "y": 168.74}, {"x": 1417, "y": 168.1}, {"x": 1418, "y": 163.34}, {"x": 1419, "y": 162.52}, {"x": 1420, "y": 166.38}, {"x": 1421, "y": 169.42}, {"x": 1422, "y": 170.0}, {"x": 1423, "y": 175.71}, {"x": 1424, "y": 179.22}, {"x": 1425, "y": 183.48}, {"x": 1426, "y": 181.86}, {"x": 1427, "y": 186.16}]}];
        var boxes = [{"Cycle": 3, "Box_ID": 1, "Start_Day": 451, "Start_Timestamp": "2023/02/02", "Start_Rate": 35.92, "Low_Day": 487, "Low_Timestamp": "2023/03/10", "Low_Rate": 28.95, "End_Day": 491, "End_Timestamp": "2023/03/14", "End_Rate": 39.08, "Drop_Percent": 6.97, "Duration_Days": 40, "Box_Broken": true, "color": "#3B82F6"}, {"Cycle": 3, "Box_ID": 2, "Start_Day": 507, "Start_Timestamp": "2023/03/30", "Start_Rate": 43.22, "Low_Day": 584, "Low_Timestamp": "2023/06/15", "Low_Rate": 36.73, "End_Day": 590, "End_Timestamp": "2023/06/21", "End_Rate": 45.61, "Drop_Percent": 6.49, "Duration_Days": 83, "Box_Broken": true, "color": "#10B981"}, {"Cycle": 3, "Box_ID": 3, "Start_Day": 592, "Start_Timestamp": "2023/06/23", "Start_Rate": 46.55, "Low_Day": 672, "Low_Timestamp": "2023/09/11", "Low_Rate": 36.88, "End_Day": 714, "End_Timestamp": "2023/10/23", "End_Rate": 51.45, "Drop_Percent": 9.67, "Duration_Days": 122, "Box_Broken": true, "color": "#EF4444"}, {"Cycle": 3, "Box_ID": 4, "Start_Day": 760, "Start_Timestamp": "2023/12/08", "Start_Rate": 66.2, "Low_Day": 763, "Low_Timestamp": "2023/12/11", "Low_Rate": 59.57, "End_Day": 785, "End_Timestamp": "2024/01/02", "End_Rate": 67.94, "Drop_Percent": 6.63, "Duration_Days": 25, "Box_Broken": true, "color": "#F59E0B"}, {"Cycle": 3, "Box_ID": 5, "Start_Day": 794, "Start_Timestamp": "2024/01/11", "Start_Rate": 72.52, "Low_Day": 806, "Low_Timestamp": "2024/01/23", "Low_Rate": 57.1, "End_Day": 826, "End_Timestamp": "2024/02/12", "End_Rate": 74.54, "Drop_Percent": 15.42, "Duration_Days": 32, "Box_Broken": true, "color": "#8B5CF6"}, {"Cycle": 3, "Box_ID": 6, "Start_Day": 857, "Start_Timestamp": "2024/03/14", "Start_Rate": 109.26, "Low_Day": 1001, "Low_Timestamp": "2024/08/05", "Low_Rate": 72.56, "End_Day": 1094, "End_Timestamp": "2024/11/06", "End_Rate": 113.14, "Drop_Percent": 36.69, "Duration_Days": 237, "Box_Broken": true, "color": "#EC4899"}, {"Cycle": 3, "Box_ID": 7, "Start_Day": 1110, "Start_Timestamp": "2024/11/22", "Start_Rate": 147.48, "Low_Day": 1114, "Low_Timestamp": "2024/11/26", "Low_Rate": 134.45, "End_Day": 1123, "End_Timestamp": "2024/12/05", "End_Rate": 154.15, "Drop_Percent": 13.03, "Duration_Days": 13, "Box_Broken": true, "color": "#06B6D4"}, {"Cycle": 3, "Box_ID": 8, "Start_Day": 1135, "Start_Timestamp": "2024/12/17", "Start_Rate": 160.46, "Low_Day": 1246, "Low_Timestamp": "2025/04/07", "Low_Rate": 110.34, "End_Day": 1290, "End_Timestamp": "2025/05/21", "End_Rate": 164.08, "Drop_Percent": 50.12, "Duration_Days": 155, "Box_Broken": true, "color": "#84CC16"}, {"Cycle": 3, "Box_ID": 9, "Start_Day": 1291, "Start_Timestamp": "2025/05/22", "Start_Rate": 165.83, "Low_Day": 1322, "Low_Timestamp": "2025/06/22", "Low_Rate": 145.43, "End_Day": 1340, "End_Timestamp": "2025/07/10", "End_Rate": 173.07, "Drop_Percent": 20.41, "Duration_Days": 49, "Box_Broken": true, "color": "#3B82F6"}, {"Cycle": 3, "Box_ID": 10, "Start_Day": 1344, "Start_Timestamp": "2025/07/14", "Start_Rate": 182.48, "Low_Day": 1393, "Low_Timestamp": "2025/09/01", "Low_Rate": 158.84, "End_Day": 1427, "End_Timestamp": "2025/10/05", "End_Rate": 186.16, "Drop_Percent": 23.64, "Duration_Days": 83, "Box_Broken": true, "color": "#10B981"}];
        var chartInstance = null;

        // 마우스 위치에 따른 박스 정보 표시
        function getBoxAtPosition(dayX) {
            for (let box of boxes) {
                if (dayX >= box.Start_Day && dayX <= box.End_Day) {
                    return box;
                }
            }
            return null;
        }
        
        // 박스 사각형 그리기 함수
        function drawBoxRects(chartContext) {
            if (!chartContext) return;
            
            var chartEl = chartContext.el;
            var gridRect = chartEl.querySelector('.apexcharts-grid');
            if (!gridRect) return;
            
            // 기존 박스 rect 제거
            var oldRects = chartEl.querySelectorAll('.box-rect-group');
            oldRects.forEach(function(el) { el.remove(); });
            
            // 새 그룹 생성
            var rectGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            rectGroup.setAttribute('class', 'box-rect-group');
            
            var w = chartContext.w;
            
            // X축, Y축 config에서 고정값 사용
            var xMin = w.config.xaxis.min !== undefined ? w.config.xaxis.min : w.globals.minX;
            var xMax = w.config.xaxis.max !== undefined ? w.config.xaxis.max : w.globals.maxX;
            var yMin = w.config.yaxis[0].min !== undefined ? w.config.yaxis[0].min : 0;
            var yMax = w.config.yaxis[0].max !== undefined ? w.config.yaxis[0].max : 100;
            
            // 실제 그리드 영역 계산 (SVG 요소에서 직접)
            var gridBBox = gridRect.getBBox();
            var gridX = gridBBox.x;
            var gridY = gridBBox.y;
            var gridWidth = gridBBox.width;
            var gridHeight = gridBBox.height;
            
            boxes.forEach(function(box) {
                // X 좌표 계산 (Start_Day ~ End_Day)
                var x1 = gridX + ((box.Start_Day - xMin) / (xMax - xMin)) * gridWidth;
                var x2 = gridX + ((box.End_Day - xMin) / (xMax - xMin)) * gridWidth;
                
                // Y 좌표 계산 (bull: Start_Rate가 고점, Low_Rate가 저점)
                var yTop = gridY + ((yMax - box.Start_Rate) / (yMax - yMin)) * gridHeight;
                var yBottom = gridY + ((yMax - box.Low_Rate) / (yMax - yMin)) * gridHeight;
                
                var rectWidth = Math.abs(x2 - x1);
                var rectHeight = Math.abs(yBottom - yTop);
                var rectX = Math.min(x1, x2);
                var rectY = Math.min(yTop, yBottom);
                
                // 화면 범위 체크
                if (rectWidth > 0 && rectHeight > 0) {
                    var rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                    rect.setAttribute('x', rectX);
                    rect.setAttribute('y', rectY);
                    rect.setAttribute('width', rectWidth);
                    rect.setAttribute('height', rectHeight);
                    rect.setAttribute('fill', box.color);
                    rect.setAttribute('fill-opacity', '0.15');
                    rect.setAttribute('stroke', box.color);
                    rect.setAttribute('stroke-width', '1.5');
                    rect.setAttribute('stroke-opacity', '0.8');
                    rectGroup.appendChild(rect);
                }
            });
            
            // grid 뒤에 삽입
            if (gridRect && gridRect.parentNode) {
                gridRect.parentNode.insertBefore(rectGroup, gridRect);
            }
        }

        // point annotations (고점/저점 마커)
        var pointAnnotations = [];
        var highColor = '#EF4444';  // 고점: 빨강
        var lowColor = '#10B981';   // 저점: 초록
        
        boxes.forEach(function(box, idx) {
            // 전저점 찾기 (이전 박스의 저점, 없으면 현재 고점 기준)
            var prevLow = idx > 0 ? boxes[idx - 1].Low_Rate : box.Start_Rate;
            var riseFromPrevLow = ((box.Start_Rate - prevLow) / prevLow * 100).toFixed(0);
            
            // 고점 대비 하락률
            var dropFromHigh = (-(box.Start_Rate - box.Low_Rate) / box.Start_Rate * 100).toFixed(0);
            
            // 고점 마커 (삼각형, 원 위에 라벨)
            pointAnnotations.push({
                x: box.Start_Day,
                y: box.Start_Rate,
                marker: { size: 5, fillColor: highColor, strokeColor: '#fff', strokeWidth: 1, shape: 'triangle' },
                label: { 
                    borderColor: highColor, 
                    style: { color: '#fff', background: highColor, fontSize: '9px', padding: { left: 4, right: 4, top: 1, bottom: 1 } }, 
                    text: 'H' + box.Box_ID + ' ' + box.Start_Rate + '% 전저점:+' + riseFromPrevLow + '%', 
                    offsetY: -8 
                }
            });
            
            // 저점 마커 (원, 원 아래에 라벨)
            pointAnnotations.push({
                x: box.Low_Day,
                y: box.Low_Rate,
                marker: { size: 5, fillColor: lowColor, strokeColor: '#fff', strokeWidth: 1 },
                label: { 
                    borderColor: lowColor, 
                    style: { color: '#fff', background: lowColor, fontSize: '9px', padding: { left: 4, right: 4, top: 1, bottom: 1 } }, 
                    text: 'L' + box.Box_ID + ' ' + box.Low_Rate + '% 고점:' + dropFromHigh + '%', 
                    offsetY: 38,
                    position: 'bottom'
                }
            });
        });

        var options = {
            chart: { 
                type: 'line', 
                height: '100%', 
                fontFamily: "'JetBrains Mono', monospace", 
                background: 'transparent', 
                toolbar: { show: true }, 
                zoom: { enabled: true, type: 'xy' },
                events: {
                    mounted: function(chartContext, config) {
                        chartInstance = chartContext;
                        setTimeout(function() { drawBoxRects(chartContext); }, 100);
                    },
                    updated: function(chartContext, config) {
                        setTimeout(function() { drawBoxRects(chartContext); }, 50);
                    },
                    zoomed: function(chartContext, config) {
                        setTimeout(function() { drawBoxRects(chartContext); }, 50);
                    },
                    beforeResetZoom: function(chartContext, config) {
                        setTimeout(function() { drawBoxRects(chartContext); }, 100);
                        return config;
                    },
                    animationEnd: function(chartContext, config) {
                        drawBoxRects(chartContext);
                    },
                    selection: function(chartContext, config) {
                        setTimeout(function() { drawBoxRects(chartContext); }, 50);
                    }
                }
            },
            series: series,
            colors: ['#3B82F6'],
            stroke: { curve: 'smooth', width: 2 },
            grid: { borderColor: 'rgba(255,255,255,0.08)', strokeDashArray: 4 },
            xaxis: { type: 'numeric', min: 420, max: 1427, tickAmount: 10, title: { text: 'Days Since Peak', style: { color: '#94A3B8' } }, labels: { style: { colors: '#94A3B8' } } },
            yaxis: { min: 0, max: 210, tickAmount: 10, title: { text: 'Rate (% of Peak)', style: { color: '#94A3B8' } }, labels: { style: { colors: '#94A3B8' }, formatter: function(v) { return v + '%'; } } },
            tooltip: { 
                theme: 'dark',
                custom: function({series, seriesIndex, dataPointIndex, w}) {
                    var data = w.globals.initialSeries[seriesIndex].data;
                    var point = data[dataPointIndex];
                    var dayX = point.x;
                    var val = point.y.toFixed(2);
                    var box = getBoxAtPosition(dayX);
                    
                    if (box) {
                        return '<div style="padding:12px; background:' + box.color + '; border-radius:6px; color:#000; font-weight:bold; border:2px solid #fff;">' +
                            'Box ' + box.Box_ID + '<br/>' +
                            '<span style="font-size:14px;">-' + box.Drop_Percent.toFixed(1) + '%</span><br/>' +
                            '<span style="font-size:11px;">Day ' + box.Start_Day + '-' + box.End_Day + ' (' + box.Duration_Days + 'd)</span><br/>' +
                            '<span style="font-size:10px;opacity:0.9;">High: ' + box.Start_Rate + '% → Low: ' + box.Low_Rate + '%</span>' +
                            '</div>';
                    }
                    
                    return '<div style="padding:8px; background:rgba(59,130,246,0.9); border-radius:6px; color:#fff;">' +
                        '<span>Day ' + dayX + '</span><br/>' +
                        '<span style="font-size:12px;">Rate: ' + val + '%</span>' +
                        '</div>';
                }
            },
            annotations: { points: pointAnnotations },
            legend: { show: false }
        };

        var chart = new ApexCharts(document.querySelector("#chart"), options);
        chart.render();
        
        // 홈 버튼 클릭 감지 (toolbar 버튼 클릭 시 박스 다시 그리기)
        setTimeout(function() {
            var toolbar = document.querySelector('.apexcharts-toolbar');
            if (toolbar) {
                toolbar.addEventListener('click', function(e) {
                    // 홈 버튼 또는 다른 툴바 버튼 클릭 시
                    setTimeout(function() {
                        if (chartInstance) drawBoxRects(chartInstance);
                    }, 300);
                });
            }
            
            // MutationObserver로 차트 변경 감지
            var chartEl = document.querySelector('#chart');
            var observer = new MutationObserver(function(mutations) {
                if (chartInstance) {
                    setTimeout(function() { drawBoxRects(chartInstance); }, 50);
                }
            });
            observer.observe(chartEl, { childList: true, subtree: true });
        }, 500);
    </script>
</body>
</html>